================================================================================
[2025-09-10 00:19:53] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-10 00:19:53] [RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-10 00:19:56] [OK] Отримано 6 записів з Єноту
[2025-09-10 00:19:56] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-10 00:19:56] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-10 00:19:56] [TIME] Час виконання скрипта import_enote_reference.py: 3.07 сек.
[2025-09-10 00:19:56] [RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-10 00:20:21] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-10 00:20:21] [TIME] Час виконання скрипта auto_fill_idx.py: 25.18 сек.
[2025-09-10 00:20:21] [RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-10 00:21:03] 
[2025-09-10 00:21:03] [LOG] Початок перевірки графіка — 2025-09-10 00:20:21
[2025-09-10 00:21:03] [LOG] Отримано 31 співробітників з Єнота
[2025-09-10 00:21:03] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-10 00:21:03] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-10 00:21:03] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-10 00:21:03] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 311
[2025-09-10 00:21:03] 
[2025-09-10 00:21:03] [TIME] Час виконання скрипта diagnose_sheets.py: 41.98 сек.
[2025-09-10 00:21:03] [RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-10 00:21:55] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-10 00:21:55] [OK] Таблиця очищена та заголовок додано.
[2025-09-10 00:21:55] [INFO] Формування нових рядків...
[2025-09-10 00:21:55] [OK] Додано 311 актуальних рядків.
[2025-09-10 00:21:55] [INFO] Перевірка на конфлікти...
[2025-09-10 00:21:55] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-10 00:21:55] [INFO] Оновлюємо колонку 'Error'...
[2025-09-10 00:21:55] [INFO] Формуємо перекреслення...
[2025-09-10 00:21:55] 
[2025-09-10 00:21:55] [OK] Конфліктів не знайдено.
[2025-09-10 00:21:55] 
[2025-09-10 00:21:55] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-10 00:21:56] [TIME] Час виконання скрипта fill_flat_schedule.py: 52.6 сек.
[2025-09-10 00:21:56] [RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-10 00:21:58] [INFO] Нічого не видалено.
[2025-09-10 00:21:58] [OK] Додано: 0, Оновлено: 311, Пропущено: 0
[2025-09-10 00:21:58] [TIME] Час виконання скрипта worktime.py: 2.24 сек.
[2025-09-10 00:21:58] [RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-10 00:22:14] [START] Скрипт запущено: 2025-09-10 00:21:58
[2025-09-10 00:22:14] [OK] Отримано 23 рядків із Google Sheets.
[2025-09-10 00:22:14] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-10 00:22:14] [OK] Діапазони захищено у Google Sheets.
[2025-09-10 00:22:14] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-10 00:22:14] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-10 00:22:14] [OK] Дані оновлені у Google Sheets.
[2025-09-10 00:22:14] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 23 рядків.
[2025-09-10 00:22:14] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 16.36 сек.
[2025-09-10 00:22:14] [RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-10 00:22:18] [2025-09-10 00:22:15] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-10 00:22:18] [2025-09-10 00:22:17] [OK] Google Sheets оновлено!
[2025-09-10 00:22:18] [2025-09-10 00:22:17] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-09-10 00:22:18] [2025-09-10 00:22:17] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-10 00:22:18] [2025-09-10 00:22:18] [OK] Обробка завершена!
[2025-09-10 00:22:18] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.68 сек.
[2025-09-10 00:22:18] [RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-10 00:22:19] [INFO] Виконуємо SQL-запит...
[2025-09-10 00:22:19] Traceback (most recent call last):
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
[2025-09-10 00:22:19]     self.dialect.do_execute(
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
[2025-09-10 00:22:19]     cursor.execute(statement, parameters)
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
[2025-09-10 00:22:19]     result = self._query(query)
[2025-09-10 00:22:19]              ^^^^^^^^^^^^^^^^^^
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
[2025-09-10 00:22:19]     conn.query(q)
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/connections.py", line 558, in query
[2025-09-10 00:22:19]     self._affected_rows = self._read_query_result(unbuffered=unbuffered)
[2025-09-10 00:22:19]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/connections.py", line 822, in _read_query_result
[2025-09-10 00:22:19]     result.read()
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1200, in read
[2025-09-10 00:22:19]     first_packet = self.connection._read_packet()
[2025-09-10 00:22:19]                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/connections.py", line 772, in _read_packet
[2025-09-10 00:22:19]     packet.raise_for_error()
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 221, in raise_for_error
[2025-09-10 00:22:19]     err.raise_mysql_exception(self._data)
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
[2025-09-10 00:22:19]     raise errorclass(errno, errval)
[2025-09-10 00:22:19] pymysql.err.OperationalError: (1267, "Illegal mix of collations (utf8mb4_unicode_ci,IMPLICIT) and (utf8mb4_0900_ai_ci,IMPLICIT) for operation '='")
[2025-09-10 00:22:19] 
[2025-09-10 00:22:19] The above exception was the direct cause of the following exception:
[2025-09-10 00:22:19] 
[2025-09-10 00:22:19] Traceback (most recent call last):
[2025-09-10 00:22:19]   File "/root/Python/ZP/zp_sales_salary_new.py", line 164, in <module>
[2025-09-10 00:22:19]     df = pd.read_sql(sql_query, con=engine)
[2025-09-10 00:22:19]          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 736, in read_sql
[2025-09-10 00:22:19]     return pandas_sql.read_query(
[2025-09-10 00:22:19]            ^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1848, in read_query
[2025-09-10 00:22:19]     result = self.execute(sql, params)
[2025-09-10 00:22:19]              ^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1671, in execute
[2025-09-10 00:22:19]     return self.con.exec_driver_sql(sql, *args)
[2025-09-10 00:22:19]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1775, in exec_driver_sql
[2025-09-10 00:22:19]     ret = self._execute_context(
[2025-09-10 00:22:19]           ^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
[2025-09-10 00:22:19]     return self._exec_single_context(
[2025-09-10 00:22:19]            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
[2025-09-10 00:22:19]     self._handle_dbapi_exception(
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
[2025-09-10 00:22:19]     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
[2025-09-10 00:22:19]     self.dialect.do_execute(
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
[2025-09-10 00:22:19]     cursor.execute(statement, parameters)
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
[2025-09-10 00:22:19]     result = self._query(query)
[2025-09-10 00:22:19]              ^^^^^^^^^^^^^^^^^^
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
[2025-09-10 00:22:19]     conn.query(q)
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/connections.py", line 558, in query
[2025-09-10 00:22:19]     self._affected_rows = self._read_query_result(unbuffered=unbuffered)
[2025-09-10 00:22:19]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/connections.py", line 822, in _read_query_result
[2025-09-10 00:22:19]     result.read()
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1200, in read
[2025-09-10 00:22:19]     first_packet = self.connection._read_packet()
[2025-09-10 00:22:19]                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/connections.py", line 772, in _read_packet
[2025-09-10 00:22:19]     packet.raise_for_error()
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 221, in raise_for_error
[2025-09-10 00:22:19]     err.raise_mysql_exception(self._data)
[2025-09-10 00:22:19]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
[2025-09-10 00:22:19]     raise errorclass(errno, errval)
[2025-09-10 00:22:19] sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1267, "Illegal mix of collations (utf8mb4_unicode_ci,IMPLICIT) and (utf8mb4_0900_ai_ci,IMPLICIT) for operation '='")
[2025-09-10 00:22:19] [SQL:
[2025-09-10 00:22:19] WITH our_table AS (
[2025-09-10 00:22:19]     -- Призначив (Сотрудник)
[2025-09-10 00:22:19]     SELECT
[2025-09-10 00:22:19]         pr.Recorder,
[2025-09-10 00:22:19]         pr.LineNumber,
[2025-09-10 00:22:19]         pr.Period,
[2025-09-10 00:22:19]         pr.Recorder_Type,
[2025-09-10 00:22:19]         pr.Номенклатура_Key,
[2025-09-10 00:22:19]         nom.Description AS Ном_Description,
[2025-09-10 00:22:19]         nom.АналитикаПоЗарплате_Key,
[2025-09-10 00:22:19]         an.Description AS Ан_Description,
[2025-09-10 00:22:19]         nom.ВидНоменклатуры,
[2025-09-10 00:22:19]         nom.Вид_Key,
[2025-09-10 00:22:19]         pr.Сотрудник AS Співробітник,
[2025-09-10 00:22:19]         sp.Графік,
[2025-09-10 00:22:19]         'Призначив' AS Role,
[2025-09-10 00:22:19]         pr.Количество,
[2025-09-10 00:22:19]         pr.КоличествоОплачено,
[2025-09-10 00:22:19]         pr.Стоимость,
[2025-09-10 00:22:19]         pr.СтоимостьБезСкидок,
[2025-09-10 00:22:19]         pr.СуммаЗатрат,
[2025-09-10 00:22:19]         (pr.Стоимость - pr.СуммаЗатрат) AS ВаловийПрибуток
[2025-09-10 00:22:19]     FROM petwealth.et_AccumulationRegister_Продажи_RecordType AS pr
[2025-09-10 00:22:19]     LEFT JOIN petwealth.et_Catalog_Номенклатура AS nom
[2025-09-10 00:22:19]         ON pr.Номенклатура_Key = nom.Ref_Key
[2025-09-10 00:22:19]     LEFT JOIN petwealth.et_Catalog_АналитикаПоЗарплате AS an
[2025-09-10 00:22:19]         ON nom.АналитикаПоЗарплате_Key = an.Ref_Key
[2025-09-10 00:22:19]     LEFT JOIN petwealth.zp_довСпівробітники AS sp
[2025-09-10 00:22:19]         ON pr.Сотрудник = sp.Ref_Key
[2025-09-10 00:22:19]     WHERE pr.Active = 1 AND pr.Period >= '2025-05-01'
[2025-09-10 00:22:19] 
[2025-09-10 00:22:19]     UNION ALL
[2025-09-10 00:22:19] 
[2025-09-10 00:22:19]     -- Виконавець (Исполнитель)
[2025-09-10 00:22:19]     SELECT
[2025-09-10 00:22:19]         pr.Recorder,
[2025-09-10 00:22:19]         pr.LineNumber,
[2025-09-10 00:22:19]         pr.Period,
[2025-09-10 00:22:19]         pr.Recorder_Type,
[2025-09-10 00:22:19]         pr.Номенклатура_Key,
[2025-09-10 00:22:19]         nom.Description AS Ном_Description,
[2025-09-10 00:22:19]         nom.АналитикаПоЗарплате_Key,
[2025-09-10 00:22:19]         an.Description AS Ан_Description,
[2025-09-10 00:22:19]         nom.ВидНоменклатуры,
[2025-09-10 00:22:19]         nom.Вид_Key,
[2025-09-10 00:22:19]         pr.Исполнитель AS Співробітник,
[2025-09-10 00:22:19]         sp.Графік,
[2025-09-10 00:22:19]         'Виконавець' AS Role,
[2025-09-10 00:22:19]         pr.Количество,
[2025-09-10 00:22:19]         pr.КоличествоОплачено,
[2025-09-10 00:22:19]         pr.Стоимость,
[2025-09-10 00:22:19]         pr.СтоимостьБезСкидок,
[2025-09-10 00:22:19]         pr.СуммаЗатрат,
[2025-09-10 00:22:19]         (pr.Стоимость - pr.СуммаЗатрат) AS ВаловийПрибуток
[2025-09-10 00:22:19]     FROM petwealth.et_AccumulationRegister_Продажи_RecordType AS pr
[2025-09-10 00:22:19]     LEFT JOIN petwealth.et_Catalog_Номенклатура AS nom
[2025-09-10 00:22:19]         ON pr.Номенклатура_Key = nom.Ref_Key
[2025-09-10 00:22:19]     LEFT JOIN petwealth.et_Catalog_АналитикаПоЗарплате AS an
[2025-09-10 00:22:19]         ON nom.АналитикаПоЗарплате_Key = an.Ref_Key
[2025-09-10 00:22:19]     LEFT JOIN petwealth.zp_довСпівробітники AS sp
[2025-09-10 00:22:19]         ON pr.Исполнитель = sp.Ref_Key
[2025-09-10 00:22:19]     WHERE pr.Active = 1 AND pr.Period >= '2025-05-01'
[2025-09-10 00:22:19] )
[2025-09-10 00:22:19] SELECT
[2025-09-10 00:22:19]     o.*,
[2025-09-10 00:22:19]     w.position,
[2025-09-10 00:22:19]     w.level,
[2025-09-10 00:22:19]     w.department,
[2025-09-10 00:22:19]     w.shift_type,
[2025-09-10 00:22:19]     w.Rule_ID,
[2025-09-10 00:22:19]     w.shift_uuid,  -- з zp_worktime
[2025-09-10 00:22:19]     CASE
[2025-09-10 00:22:19]         WHEN o.Role = 'Призначив' THEN pay.Ан_Призначив
[2025-09-10 00:22:19]         WHEN o.Role = 'Виконавець' THEN pay.Ан_Виконав
[2025-09-10 00:22:19]         ELSE 0
[2025-09-10 00:22:19]     END AS ВідсотокПремії,
[2025-09-10 00:22:19]     ROUND(CASE
[2025-09-10 00:22:19]         WHEN o.Role = 'Призначив' THEN pay.Ан_Призначив * o.Стоимость
[2025-09-10 00:22:19]         WHEN o.Role = 'Виконавець' THEN pay.Ан_Виконав * o.Стоимость
[2025-09-10 00:22:19]         ELSE 0
[2025-09-10 00:22:19]     END, 2) AS ПреміяСтоимость,
[2025-09-10 00:22:19]     ROUND(CASE
[2025-09-10 00:22:19]         WHEN o.Role = 'Призначив' THEN pay.Ан_Призначив * o.СтоимостьБезСкидок
[2025-09-10 00:22:19]         WHEN o.Role = 'Виконавець' THEN pay.Ан_Виконав * o.СтоимостьБезСкидок
[2025-09-10 00:22:19]         ELSE 0
[2025-09-10 00:22:19]     END, 2) AS ПреміяСтоимостьБезСкидок,
[2025-09-10 00:22:19]     ROUND(CASE
[2025-09-10 00:22:19]         WHEN o.Role = 'Призначив' THEN pay.Ан_Призначив * o.ВаловийПрибуток
[2025-09-10 00:22:19]         WHEN o.Role = 'Виконавець' THEN pay.Ан_Виконав * o.ВаловийПрибуток
[2025-09-10 00:22:19]         ELSE 0
[2025-09-10 00:22:19]     END, 2) AS ПреміяВаловийПрибуток
[2025-09-10 00:22:19] FROM our_table o
[2025-09-10 00:22:19] LEFT JOIN petwealth.zp_worktime w
[2025-09-10 00:22:19]     ON o.Графік = w.last_name
[2025-09-10 00:22:19]     AND o.Period >= w.time_start
[2025-09-10 00:22:19]     AND o.Period <  w.time_end
[2025-09-10 00:22:19] LEFT JOIN petwealth.zp_фктУмовиОплати pay
[2025-09-10 00:22:19]     ON w.Rule_ID = pay.Rule_ID
[2025-09-10 00:22:19]     AND pay.АнЗП = o.Ан_Description
[2025-09-10 00:22:19]     AND (pay.ДатаПочатку IS NULL OR o.Period >= pay.ДатаПочатку)
[2025-09-10 00:22:19]     AND (pay.ДатаЗакінчення IS NULL OR o.Period <= pay.ДатаЗакінчення)
[2025-09-10 00:22:19] WHERE o.Period >= '2025-05-01'
[2025-09-10 00:22:19] ]
[2025-09-10 00:22:19] (Background on this error at: https://sqlalche.me/e/20/e3q8)
[2025-09-10 00:22:19] [TIME] Час виконання скрипта zp_sales_salary_new.py: 1.02 сек.
[2025-09-10 00:22:19] [ERROR] Помилка виконання: zp_sales_salary_new.py (exit=1). Зупиняємо.
[2025-09-10 00:22:19] [FINISH] Загальний час виконання: 146.12 сек.
================================================================================
[2025-09-10 00:54:01] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-10 00:54:01] [RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-10 00:54:05] [OK] Отримано 6 записів з Єноту
[2025-09-10 00:54:05] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-10 00:54:05] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-10 00:54:05] [TIME] Час виконання скрипта import_enote_reference.py: 4.6 сек.
[2025-09-10 00:54:05] [RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-10 00:54:31] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-10 00:54:31] [TIME] Час виконання скрипта auto_fill_idx.py: 26.18 сек.
[2025-09-10 00:54:31] [RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-10 00:55:11] 
[2025-09-10 00:55:11] [LOG] Початок перевірки графіка — 2025-09-10 00:54:32
[2025-09-10 00:55:11] [LOG] Отримано 31 співробітників з Єнота
[2025-09-10 00:55:11] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-10 00:55:11] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-10 00:55:11] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-10 00:55:11] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 311
[2025-09-10 00:55:11] 
[2025-09-10 00:55:11] [TIME] Час виконання скрипта diagnose_sheets.py: 39.64 сек.
[2025-09-10 00:55:11] [RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-10 00:56:10] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-10 00:56:10] [OK] Таблиця очищена та заголовок додано.
[2025-09-10 00:56:10] [INFO] Формування нових рядків...
[2025-09-10 00:56:10] [OK] Додано 311 актуальних рядків.
[2025-09-10 00:56:10] [INFO] Перевірка на конфлікти...
[2025-09-10 00:56:10] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-10 00:56:10] [INFO] Оновлюємо колонку 'Error'...
[2025-09-10 00:56:10] [INFO] Формуємо перекреслення...
[2025-09-10 00:56:10] 
[2025-09-10 00:56:10] [OK] Конфліктів не знайдено.
[2025-09-10 00:56:10] 
[2025-09-10 00:56:10] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-10 00:56:10] [TIME] Час виконання скрипта fill_flat_schedule.py: 59.06 сек.
[2025-09-10 00:56:10] [RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-10 00:56:13] [INFO] Нічого не видалено.
[2025-09-10 00:56:13] [OK] Додано: 0, Оновлено: 311, Пропущено: 0
[2025-09-10 00:56:13] [TIME] Час виконання скрипта worktime.py: 3.04 сек.
[2025-09-10 00:56:13] [RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-10 00:56:30] [START] Скрипт запущено: 2025-09-10 00:56:14
[2025-09-10 00:56:30] [OK] Отримано 23 рядків із Google Sheets.
[2025-09-10 00:56:30] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-10 00:56:30] [OK] Діапазони захищено у Google Sheets.
[2025-09-10 00:56:30] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-10 00:56:30] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-10 00:56:30] [OK] Дані оновлені у Google Sheets.
[2025-09-10 00:56:30] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 23 рядків.
[2025-09-10 00:56:30] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 16.99 сек.
[2025-09-10 00:56:30] [RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-10 00:56:34] [2025-09-10 00:56:31] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-10 00:56:34] [2025-09-10 00:56:33] [OK] Google Sheets оновлено!
[2025-09-10 00:56:34] [2025-09-10 00:56:33] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-09-10 00:56:34] [2025-09-10 00:56:33] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-10 00:56:34] [2025-09-10 00:56:34] [OK] Обробка завершена!
[2025-09-10 00:56:34] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.91 сек.
[2025-09-10 00:56:34] [RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-10 00:57:08] [INFO] Виконуємо SQL-запит...
[2025-09-10 00:57:08] [OK] Отримано 40690 рядків
[2025-09-10 00:57:08] [OK] Дублікатів за ключовими полями немає.
[2025-09-10 00:57:08] [DELETE] Очищення старих записів...
[2025-09-10 00:57:08] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-09-10 00:57:08] [OK] Дані успішно завантажені!
[2025-09-10 00:57:08] [TIME] Час виконання скрипта zp_sales_salary_new.py: 33.92 сек.
[2025-09-10 00:57:08] [RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-09-10 00:57:12] [SYNC] Розпочато обробку змін...
[2025-09-10 00:57:12] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-09-10 00:57:12] [OK] Отримано 311 змін для обробки.
[2025-09-10 00:57:12] [FINISH] Обробка завершена: 58 записів премій.
[2025-09-10 00:57:12] [TIME] Час виконання скрипта zp_collective_bonus.py: 3.76 сек.
[2025-09-10 00:57:12] [RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-09-10 00:57:13] 
[2025-09-10 00:57:13] ===============================
[2025-09-10 00:57:13] Період від 2025-05-01
[2025-09-10 00:57:13] По Стоимость: 479,688.22
[2025-09-10 00:57:13] По СтоимостьБезСкидок: 480,705.14
[2025-09-10 00:57:13] По ВаловийПрибуток: 466,272.67
[2025-09-10 00:57:13] ===============================
[2025-09-10 00:57:13] 
[2025-09-10 00:57:13] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-09-10 00:57:14] [TIME] Час виконання скрипта summary.py: 1.85 сек.
[2025-09-10 00:57:14] [FINISH] Загальний час виконання: 192.96 сек.
================================================================================
[2025-09-10 01:15:45] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-10 01:15:45] [RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-10 01:15:48] [OK] Отримано 6 записів з Єноту
[2025-09-10 01:15:48] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-10 01:15:48] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-10 01:15:48] [TIME] Час виконання скрипта import_enote_reference.py: 3.3 сек.
[2025-09-10 01:15:48] [RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-10 01:16:16] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-10 01:16:16] [TIME] Час виконання скрипта auto_fill_idx.py: 27.75 сек.
[2025-09-10 01:16:16] [RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-10 01:16:29] [FINISH] Загальний час виконання: 43.71 сек.
================================================================================
[2025-09-10 01:16:32] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-10 01:16:32] [RUN] Виконую скрипт: import_enote_reference.py /n
------------------------------------------------------------
[2025-09-10 01:16:35] [OK] Отримано 6 записів з Єноту
[2025-09-10 01:16:35] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-10 01:16:35] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-10 01:16:35] [TIME] Час виконання скрипта import_enote_reference.py: 2.9 сек.
[2025-09-10 01:16:35] [RUN] Виконую скрипт: auto_fill_idx.py /n
------------------------------------------------------------
[2025-09-10 01:16:58] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-10 01:16:58] [TIME] Час виконання скрипта auto_fill_idx.py: 23.38 сек.
[2025-09-10 01:16:58] [RUN] Виконую скрипт: diagnose_sheets.py /n
------------------------------------------------------------
[2025-09-10 01:17:39] 
[2025-09-10 01:17:39] [LOG] Початок перевірки графіка — 2025-09-10 01:16:59
[2025-09-10 01:17:39] [LOG] Отримано 31 співробітників з Єнота
[2025-09-10 01:17:39] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-10 01:17:39] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-10 01:17:39] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-10 01:17:39] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 311
[2025-09-10 01:17:39] 
[2025-09-10 01:17:39] [TIME] Час виконання скрипта diagnose_sheets.py: 40.39 сек.
[2025-09-10 01:17:39] [RUN] Виконую скрипт: fill_flat_schedule.py /n
------------------------------------------------------------
[2025-09-10 01:18:30] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-10 01:18:30] [OK] Таблиця очищена та заголовок додано.
[2025-09-10 01:18:30] [INFO] Формування нових рядків...
[2025-09-10 01:18:30] [OK] Додано 311 актуальних рядків.
[2025-09-10 01:18:30] [INFO] Перевірка на конфлікти...
[2025-09-10 01:18:30] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-10 01:18:30] [INFO] Оновлюємо колонку 'Error'...
[2025-09-10 01:18:30] [INFO] Формуємо перекреслення...
[2025-09-10 01:18:30] 
[2025-09-10 01:18:30] [OK] Конфліктів не знайдено.
[2025-09-10 01:18:30] 
[2025-09-10 01:18:30] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-10 01:18:30] [TIME] Час виконання скрипта fill_flat_schedule.py: 51.34 сек.
[2025-09-10 01:18:30] [RUN] Виконую скрипт: worktime.py /n
------------------------------------------------------------
[2025-09-10 01:18:32] [INFO] Нічого не видалено.
[2025-09-10 01:18:32] [OK] Додано: 0, Оновлено: 311, Пропущено: 0
[2025-09-10 01:18:32] [TIME] Час виконання скрипта worktime.py: 2.06 сек.
[2025-09-10 01:18:32] [RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py /n
------------------------------------------------------------
[2025-09-10 01:18:49] [START] Скрипт запущено: 2025-09-10 01:18:33
[2025-09-10 01:18:49] [OK] Отримано 24 рядків із Google Sheets.
[2025-09-10 01:18:49] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-10 01:18:49] [OK] Діапазони захищено у Google Sheets.
[2025-09-10 01:18:49] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-10 01:18:49] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-10 01:18:49] [OK] Дані оновлені у Google Sheets.
[2025-09-10 01:18:49] Traceback (most recent call last):
[2025-09-10 01:18:49]   File "/root/Python/ZP/sync_fkt_UmoviOplaty.py", line 272, in <module>
[2025-09-10 01:18:49]     cursor.execute(insert_sql, (
[2025-09-10 01:18:49]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
[2025-09-10 01:18:49]     result = self._query(query)
[2025-09-10 01:18:49]              ^^^^^^^^^^^^^^^^^^
[2025-09-10 01:18:49]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
[2025-09-10 01:18:49]     conn.query(q)
[2025-09-10 01:18:49]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/connections.py", line 558, in query
[2025-09-10 01:18:49]     self._affected_rows = self._read_query_result(unbuffered=unbuffered)
[2025-09-10 01:18:49]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 01:18:49]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/connections.py", line 822, in _read_query_result
[2025-09-10 01:18:49]     result.read()
[2025-09-10 01:18:49]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1200, in read
[2025-09-10 01:18:49]     first_packet = self.connection._read_packet()
[2025-09-10 01:18:49]                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 01:18:49]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/connections.py", line 772, in _read_packet
[2025-09-10 01:18:49]     packet.raise_for_error()
[2025-09-10 01:18:49]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 221, in raise_for_error
[2025-09-10 01:18:49]     err.raise_mysql_exception(self._data)
[2025-09-10 01:18:49]   File "/root/Python/venv/lib/python3.12/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
[2025-09-10 01:18:49]     raise errorclass(errno, errval)
[2025-09-10 01:18:49] pymysql.err.IntegrityError: (1062, "Duplicate entry '2025-07-01-Технік------' for key 'zp_фктУмовиОплати.uq_condition'")
[2025-09-10 01:18:50] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 17.42 сек.
[2025-09-10 01:18:50] [ERROR] Помилка виконання: sync_fkt_UmoviOplaty.py (exit=1). Зупиняємо.
[2025-09-10 01:18:50] [FINISH] Загальний час виконання: 137.51 сек.
================================================================================
[2025-09-10 01:33:56] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-10 01:33:56] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-10 01:33:59] [OK] Отримано 6 записів з Єноту
[2025-09-10 01:33:59] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-10 01:33:59] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-10 01:33:59] [TIME] Час виконання скрипта import_enote_reference.py: 2.4 сек.
[2025-09-10 01:33:59] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-10 01:34:24] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-10 01:34:24] [TIME] Час виконання скрипта auto_fill_idx.py: 25.01 сек.
[2025-09-10 01:34:24] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-10 01:35:04] 
[2025-09-10 01:35:04] [LOG] Початок перевірки графіка — 2025-09-10 01:34:24
[2025-09-10 01:35:04] [LOG] Отримано 31 співробітників з Єнота
[2025-09-10 01:35:04] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-10 01:35:04] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-10 01:35:04] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-10 01:35:04] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 311
[2025-09-10 01:35:04] 
[2025-09-10 01:35:04] [TIME] Час виконання скрипта diagnose_sheets.py: 39.76 сек.
[2025-09-10 01:35:04] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-10 01:36:00] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-10 01:36:00] [OK] Таблиця очищена та заголовок додано.
[2025-09-10 01:36:00] [INFO] Формування нових рядків...
[2025-09-10 01:36:00] [OK] Додано 311 актуальних рядків.
[2025-09-10 01:36:00] [INFO] Перевірка на конфлікти...
[2025-09-10 01:36:00] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-10 01:36:00] [INFO] Оновлюємо колонку 'Error'...
[2025-09-10 01:36:00] [INFO] Формуємо перекреслення...
[2025-09-10 01:36:00] 
[2025-09-10 01:36:00] [OK] Конфліктів не знайдено.
[2025-09-10 01:36:00] 
[2025-09-10 01:36:00] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-10 01:36:00] [TIME] Час виконання скрипта fill_flat_schedule.py: 56.07 сек.
[2025-09-10 01:36:00] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-10 01:36:03] [INFO] Нічого не видалено.
[2025-09-10 01:36:03] [OK] Додано: 0, Оновлено: 311, Пропущено: 0
[2025-09-10 01:36:03] [TIME] Час виконання скрипта worktime.py: 3.3 сек.
[2025-09-10 01:36:03] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-10 01:36:18] [START] Скрипт запущено: 2025-09-10 01:36:04
[2025-09-10 01:36:18] [OK] Отримано 23 рядків із Google Sheets.
[2025-09-10 01:36:18] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-10 01:36:18] [OK] Діапазони захищено у Google Sheets.
[2025-09-10 01:36:18] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-10 01:36:18] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-10 01:36:18] [OK] Дані оновлені у Google Sheets.
[2025-09-10 01:36:18] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 23 рядків.
[2025-09-10 01:36:18] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 15.39 сек.
[2025-09-10 01:36:18] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-10 01:36:21] [2025-09-10 01:36:19] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-10 01:36:21] [2025-09-10 01:36:20] [OK] Google Sheets оновлено!
[2025-09-10 01:36:21] [2025-09-10 01:36:21] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-09-10 01:36:21] [2025-09-10 01:36:21] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-10 01:36:21] [2025-09-10 01:36:21] [OK] Обробка завершена!
[2025-09-10 01:36:21] [TIME] Час виконання скрипта sync_умови_рівень.py: 2.76 сек.
[2025-09-10 01:36:21] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-10 01:36:57] [INFO] Виконуємо SQL-запит...
[2025-09-10 01:36:57] [OK] Отримано 40690 рядків
[2025-09-10 01:36:57] [OK] Дублікатів за ключовими полями немає.
[2025-09-10 01:36:57] [DELETE] Очищення старих записів...
[2025-09-10 01:36:57] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-09-10 01:36:57] [OK] Дані успішно завантажені!
[2025-09-10 01:36:57] [TIME] Час виконання скрипта zp_sales_salary_new.py: 35.91 сек.
[2025-09-10 01:36:57] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-09-10 01:37:01] [SYNC] Розпочато обробку змін...
[2025-09-10 01:37:01] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-09-10 01:37:01] [OK] Отримано 311 змін для обробки.
[2025-09-10 01:37:01] [FINISH] Обробка завершена: 58 записів премій.
[2025-09-10 01:37:01] [TIME] Час виконання скрипта zp_collective_bonus.py: 4.22 сек.
[2025-09-10 01:37:01] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-09-10 01:37:03] 
[2025-09-10 01:37:03] ===============================
[2025-09-10 01:37:03] Період від 2025-05-01
[2025-09-10 01:37:03] По Стоимость: 472,121.54
[2025-09-10 01:37:03] По СтоимостьБезСкидок: 473,138.46
[2025-09-10 01:37:03] По ВаловийПрибуток: 458,705.99
[2025-09-10 01:37:03] ===============================
[2025-09-10 01:37:03] 
[2025-09-10 01:37:03] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-09-10 01:37:03] [TIME] Час виконання скрипта summary.py: 2.03 сек.
[2025-09-10 01:37:03] [FINISH] Загальний час виконання: 186.87 сек.
================================================================================
[2025-09-10 01:41:25] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-10 01:41:25] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-10 01:41:28] [OK] Отримано 6 записів з Єноту
[2025-09-10 01:41:28] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-10 01:41:28] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-10 01:41:28] [TIME] Час виконання скрипта import_enote_reference.py: 2.91 сек.
[2025-09-10 01:41:28] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-10 01:41:53] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-10 01:41:54] [TIME] Час виконання скрипта auto_fill_idx.py: 25.36 сек.
[2025-09-10 01:41:54] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-10 01:42:34] 
[2025-09-10 01:42:34] [LOG] Початок перевірки графіка — 2025-09-10 01:41:54
[2025-09-10 01:42:34] [LOG] Отримано 31 співробітників з Єнота
[2025-09-10 01:42:34] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-10 01:42:34] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-10 01:42:34] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-10 01:42:34] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 311
[2025-09-10 01:42:34] 
[2025-09-10 01:42:34] [TIME] Час виконання скрипта diagnose_sheets.py: 40.69 сек.
[2025-09-10 01:42:34] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-10 01:43:27] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-10 01:43:27] [OK] Таблиця очищена та заголовок додано.
[2025-09-10 01:43:27] [INFO] Формування нових рядків...
[2025-09-10 01:43:27] [OK] Додано 311 актуальних рядків.
[2025-09-10 01:43:27] [INFO] Перевірка на конфлікти...
[2025-09-10 01:43:27] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-10 01:43:27] [INFO] Оновлюємо колонку 'Error'...
[2025-09-10 01:43:27] [INFO] Формуємо перекреслення...
[2025-09-10 01:43:27] 
[2025-09-10 01:43:27] [OK] Конфліктів не знайдено.
[2025-09-10 01:43:27] 
[2025-09-10 01:43:27] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-10 01:43:27] [TIME] Час виконання скрипта fill_flat_schedule.py: 52.75 сек.
[2025-09-10 01:43:27] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-10 01:43:29] [INFO] Нічого не видалено.
[2025-09-10 01:43:29] [OK] Додано: 0, Оновлено: 311, Пропущено: 0
[2025-09-10 01:43:29] [TIME] Час виконання скрипта worktime.py: 2.28 сек.
[2025-09-10 01:43:29] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-10 01:43:46] [START] Скрипт запущено: 2025-09-10 01:43:30
[2025-09-10 01:43:46] [OK] Отримано 23 рядків із Google Sheets.
[2025-09-10 01:43:46] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-10 01:43:46] [OK] Діапазони захищено у Google Sheets.
[2025-09-10 01:43:46] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-10 01:43:46] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-10 01:43:46] [OK] Дані оновлені у Google Sheets.
[2025-09-10 01:43:46] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 23 рядків.
[2025-09-10 01:43:46] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 16.83 сек.
[2025-09-10 01:43:46] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-10 01:43:49] [2025-09-10 01:43:47] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-10 01:43:49] [2025-09-10 01:43:48] [OK] Google Sheets оновлено!
[2025-09-10 01:43:49] [2025-09-10 01:43:48] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-09-10 01:43:49] [2025-09-10 01:43:48] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-10 01:43:49] [2025-09-10 01:43:49] [OK] Обробка завершена!
[2025-09-10 01:43:49] [TIME] Час виконання скрипта sync_умови_рівень.py: 2.62 сек.
[2025-09-10 01:43:49] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-10 01:44:23] [INFO] Виконуємо SQL-запит...
[2025-09-10 01:44:23] [OK] Отримано 40690 рядків
[2025-09-10 01:44:23] [OK] Дублікатів за ключовими полями немає.
[2025-09-10 01:44:23] [DELETE] Очищення старих записів...
[2025-09-10 01:44:23] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-09-10 01:44:23] [OK] Дані успішно завантажені!
[2025-09-10 01:44:23] [TIME] Час виконання скрипта zp_sales_salary_new.py: 34.18 сек.
[2025-09-10 01:44:23] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-09-10 01:44:27] [SYNC] Розпочато обробку змін...
[2025-09-10 01:44:27] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-09-10 01:44:27] [OK] Отримано 311 змін для обробки.
[2025-09-10 01:44:27] [FINISH] Обробка завершена: 58 записів премій.
[2025-09-10 01:44:27] [TIME] Час виконання скрипта zp_collective_bonus.py: 4.03 сек.
[2025-09-10 01:44:27] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-09-10 01:44:29] 
[2025-09-10 01:44:29] ===============================
[2025-09-10 01:44:29] Період від 2025-05-01
[2025-09-10 01:44:29] По Стоимость: 472,121.54
[2025-09-10 01:44:29] По СтоимостьБезСкидок: 473,138.46
[2025-09-10 01:44:29] По ВаловийПрибуток: 458,705.99
[2025-09-10 01:44:29] ===============================
[2025-09-10 01:44:29] 
[2025-09-10 01:44:29] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-09-10 01:44:29] [TIME] Час виконання скрипта summary.py: 1.78 сек.
[2025-09-10 01:44:29] [FINISH] Загальний час виконання: 183.44 сек.
================================================================================
[2025-09-10 01:45:45] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-10 01:45:45] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-10 01:45:48] [OK] Отримано 6 записів з Єноту
[2025-09-10 01:45:48] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-10 01:45:48] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-10 01:45:48] [TIME] Час виконання скрипта import_enote_reference.py: 3.09 сек.
[2025-09-10 01:45:48] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-10 01:46:16] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-10 01:46:16] [TIME] Час виконання скрипта auto_fill_idx.py: 27.27 сек.
[2025-09-10 01:46:16] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-10 01:46:56] 
[2025-09-10 01:46:56] [LOG] Початок перевірки графіка — 2025-09-10 01:46:16
[2025-09-10 01:46:56] [LOG] Отримано 31 співробітників з Єнота
[2025-09-10 01:46:56] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-10 01:46:56] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-10 01:46:56] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-10 01:46:56] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 311
[2025-09-10 01:46:56] 
[2025-09-10 01:46:56] [TIME] Час виконання скрипта diagnose_sheets.py: 40.45 сек.
[2025-09-10 01:46:56] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-10 01:47:53] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-10 01:47:53] [OK] Таблиця очищена та заголовок додано.
[2025-09-10 01:47:53] [INFO] Формування нових рядків...
[2025-09-10 01:47:53] [OK] Додано 311 актуальних рядків.
[2025-09-10 01:47:53] [INFO] Перевірка на конфлікти...
[2025-09-10 01:47:53] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-10 01:47:53] [INFO] Оновлюємо колонку 'Error'...
[2025-09-10 01:47:53] [INFO] Формуємо перекреслення...
[2025-09-10 01:47:53] 
[2025-09-10 01:47:53] [OK] Конфліктів не знайдено.
[2025-09-10 01:47:53] 
[2025-09-10 01:47:53] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-10 01:47:53] [TIME] Час виконання скрипта fill_flat_schedule.py: 57.22 сек.
[2025-09-10 01:47:53] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-10 01:47:55] [INFO] Нічого не видалено.
[2025-09-10 01:47:55] [OK] Додано: 0, Оновлено: 311, Пропущено: 0
[2025-09-10 01:47:56] [TIME] Час виконання скрипта worktime.py: 2.17 сек.
[2025-09-10 01:47:56] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-10 01:48:13] [START] Скрипт запущено: 2025-09-10 01:47:56
[2025-09-10 01:48:13] [OK] Отримано 23 рядків із Google Sheets.
[2025-09-10 01:48:13] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-10 01:48:13] [OK] Діапазони захищено у Google Sheets.
[2025-09-10 01:48:13] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-10 01:48:13] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-10 01:48:13] [OK] Дані оновлені у Google Sheets.
[2025-09-10 01:48:13] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 23 рядків.
[2025-09-10 01:48:13] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 17.33 сек.
[2025-09-10 01:48:13] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-10 01:48:16] [2025-09-10 01:48:14] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-10 01:48:16] [2025-09-10 01:48:15] [OK] Google Sheets оновлено!
[2025-09-10 01:48:16] [2025-09-10 01:48:15] [OK] Завантажено: 1 додано, 0 оновлено.
[2025-09-10 01:48:16] [2025-09-10 01:48:15] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-10 01:48:16] [2025-09-10 01:48:15] [OK] Обробка завершена!
[2025-09-10 01:48:16] [TIME] Час виконання скрипта sync_умови_рівень.py: 2.83 сек.
[2025-09-10 01:48:16] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-10 01:48:49] [INFO] Виконуємо SQL-запит...
[2025-09-10 01:48:49] [OK] Отримано 40690 рядків
[2025-09-10 01:48:49] [OK] Дублікатів за ключовими полями немає.
[2025-09-10 01:48:49] [DELETE] Очищення старих записів...
[2025-09-10 01:48:49] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-09-10 01:48:49] [OK] Дані успішно завантажені!
[2025-09-10 01:48:49] [TIME] Час виконання скрипта zp_sales_salary_new.py: 33.67 сек.
[2025-09-10 01:48:49] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-09-10 01:48:53] [SYNC] Розпочато обробку змін...
[2025-09-10 01:48:53] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-09-10 01:48:53] [OK] Отримано 311 змін для обробки.
[2025-09-10 01:48:53] [FINISH] Обробка завершена: 58 записів премій.
[2025-09-10 01:48:53] [TIME] Час виконання скрипта zp_collective_bonus.py: 3.99 сек.
[2025-09-10 01:48:53] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-09-10 01:48:55] 
[2025-09-10 01:48:55] ===============================
[2025-09-10 01:48:55] Період від 2025-05-01
[2025-09-10 01:48:55] По Стоимость: 480,579.85
[2025-09-10 01:48:55] По СтоимостьБезСкидок: 481,596.78
[2025-09-10 01:48:55] По ВаловийПрибуток: 467,164.31
[2025-09-10 01:48:55] ===============================
[2025-09-10 01:48:55] 
[2025-09-10 01:48:55] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-09-10 01:48:55] [TIME] Час виконання скрипта summary.py: 1.91 сек.
[2025-09-10 01:48:55] [FINISH] Загальний час виконання: 189.94 сек.
================================================================================
[2025-09-10 09:16:53] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-10 09:16:53] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-10 09:16:57] [OK] Отримано 6 записів з Єноту
[2025-09-10 09:16:57] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-10 09:16:57] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-10 09:16:57] [TIME] Час виконання скрипта import_enote_reference.py: 4.02 сек.
[2025-09-10 09:16:57] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-10 09:17:26] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-10 09:17:27] [TIME] Час виконання скрипта auto_fill_idx.py: 29.44 сек.
[2025-09-10 09:17:27] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-10 09:18:10] 
[2025-09-10 09:18:10] [LOG] Початок перевірки графіка — 2025-09-10 09:17:27
[2025-09-10 09:18:10] [LOG] Отримано 31 співробітників з Єнота
[2025-09-10 09:18:10] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-10 09:18:10] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-10 09:18:10] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-10 09:18:10] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 311
[2025-09-10 09:18:10] 
[2025-09-10 09:18:11] [TIME] Час виконання скрипта diagnose_sheets.py: 43.87 сек.
[2025-09-10 09:18:11] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-10 09:19:08] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-10 09:19:08] [OK] Таблиця очищена та заголовок додано.
[2025-09-10 09:19:08] [INFO] Формування нових рядків...
[2025-09-10 09:19:08] [OK] Додано 311 актуальних рядків.
[2025-09-10 09:19:08] [INFO] Перевірка на конфлікти...
[2025-09-10 09:19:08] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-10 09:19:08] [INFO] Оновлюємо колонку 'Error'...
[2025-09-10 09:19:08] [INFO] Формуємо перекреслення...
[2025-09-10 09:19:08] 
[2025-09-10 09:19:08] [OK] Конфліктів не знайдено.
[2025-09-10 09:19:08] 
[2025-09-10 09:19:08] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-10 09:19:08] [TIME] Час виконання скрипта fill_flat_schedule.py: 57.91 сек.
[2025-09-10 09:19:08] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-10 09:19:11] [INFO] Нічого не видалено.
[2025-09-10 09:19:11] [OK] Додано: 0, Оновлено: 311, Пропущено: 0
[2025-09-10 09:19:11] [TIME] Час виконання скрипта worktime.py: 2.85 сек.
[2025-09-10 09:19:11] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-10 09:19:28] [START] Скрипт запущено: 2025-09-10 09:19:12
[2025-09-10 09:19:28] [OK] Отримано 26 рядків із Google Sheets.
[2025-09-10 09:19:28] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-10 09:19:28] [OK] Діапазони захищено у Google Sheets.
[2025-09-10 09:19:28] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-10 09:19:28] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-10 09:19:28] [OK] Дані оновлені у Google Sheets.
[2025-09-10 09:19:28] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 26 рядків.
[2025-09-10 09:19:28] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 17.13 сек.
[2025-09-10 09:19:28] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-10 09:19:32] [2025-09-10 09:19:29] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-10 09:19:32] [2025-09-10 09:19:32] [OK] Google Sheets оновлено!
[2025-09-10 09:19:32] [2025-09-10 09:19:32] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-09-10 09:19:32] [2025-09-10 09:19:32] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-10 09:19:32] [2025-09-10 09:19:32] [OK] Обробка завершена!
[2025-09-10 09:19:32] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.95 сек.
[2025-09-10 09:19:32] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-10 09:20:07] [INFO] Виконуємо SQL-запит...
[2025-09-10 09:20:07] [OK] Отримано 40690 рядків
[2025-09-10 09:20:07] [OK] Дублікатів за ключовими полями немає.
[2025-09-10 09:20:07] [DELETE] Очищення старих записів...
[2025-09-10 09:20:07] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-09-10 09:20:07] [OK] Дані успішно завантажені!
[2025-09-10 09:20:07] [TIME] Час виконання скрипта zp_sales_salary_new.py: 35.1 сек.
[2025-09-10 09:20:07] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-09-10 09:20:11] [SYNC] Розпочато обробку змін...
[2025-09-10 09:20:11] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-09-10 09:20:11] [OK] Отримано 311 змін для обробки.
[2025-09-10 09:20:11] [FINISH] Обробка завершена: 58 записів премій.
[2025-09-10 09:20:11] [TIME] Час виконання скрипта zp_collective_bonus.py: 3.76 сек.
[2025-09-10 09:20:11] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-09-10 09:20:13] 
[2025-09-10 09:20:13] ===============================
[2025-09-10 09:20:13] Період від 2025-05-01
[2025-09-10 09:20:13] По Стоимость: 348,704.85
[2025-09-10 09:20:13] По СтоимостьБезСкидок: 349,721.78
[2025-09-10 09:20:13] По ВаловийПрибуток: 335,289.31
[2025-09-10 09:20:13] ===============================
[2025-09-10 09:20:13] 
[2025-09-10 09:20:13] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-09-10 09:20:13] [TIME] Час виконання скрипта summary.py: 1.67 сек.
[2025-09-10 09:20:13] [FINISH] Загальний час виконання: 199.71 сек.
================================================================================
[2025-09-10 09:28:09] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-10 09:28:09] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-10 09:28:13] [OK] Отримано 6 записів з Єноту
[2025-09-10 09:28:13] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-10 09:28:13] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-10 09:28:13] [TIME] Час виконання скрипта import_enote_reference.py: 3.77 сек.
[2025-09-10 09:28:13] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-10 09:28:41] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-10 09:28:41] [TIME] Час виконання скрипта auto_fill_idx.py: 27.9 сек.
[2025-09-10 09:28:41] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-10 09:29:25] 
[2025-09-10 09:29:25] [LOG] Початок перевірки графіка — 2025-09-10 09:28:41
[2025-09-10 09:29:25] [LOG] Отримано 31 співробітників з Єнота
[2025-09-10 09:29:25] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-10 09:29:25] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-10 09:29:25] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-10 09:29:25] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 311
[2025-09-10 09:29:25] 
[2025-09-10 09:29:25] [TIME] Час виконання скрипта diagnose_sheets.py: 44.38 сек.
[2025-09-10 09:29:25] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-10 09:30:26] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-10 09:30:26] [OK] Таблиця очищена та заголовок додано.
[2025-09-10 09:30:26] [INFO] Формування нових рядків...
[2025-09-10 09:30:26] [OK] Додано 311 актуальних рядків.
[2025-09-10 09:30:26] [INFO] Перевірка на конфлікти...
[2025-09-10 09:30:26] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-10 09:30:26] [INFO] Оновлюємо колонку 'Error'...
[2025-09-10 09:30:26] [INFO] Формуємо перекреслення...
[2025-09-10 09:30:26] 
[2025-09-10 09:30:26] [OK] Конфліктів не знайдено.
[2025-09-10 09:30:26] 
[2025-09-10 09:30:26] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-10 09:30:26] [TIME] Час виконання скрипта fill_flat_schedule.py: 61.38 сек.
[2025-09-10 09:30:26] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-10 09:30:29] [INFO] Нічого не видалено.
[2025-09-10 09:30:29] [OK] Додано: 0, Оновлено: 311, Пропущено: 0
[2025-09-10 09:30:29] [TIME] Час виконання скрипта worktime.py: 2.27 сек.
[2025-09-10 09:30:29] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-10 09:30:46] [START] Скрипт запущено: 2025-09-10 09:30:29
[2025-09-10 09:30:46] [OK] Отримано 25 рядків із Google Sheets.
[2025-09-10 09:30:46] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-10 09:30:46] [OK] Діапазони захищено у Google Sheets.
[2025-09-10 09:30:46] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-10 09:30:46] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-10 09:30:46] [OK] Дані оновлені у Google Sheets.
[2025-09-10 09:30:46] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 25 рядків.
[2025-09-10 09:30:46] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 17.33 сек.
[2025-09-10 09:30:46] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-10 09:30:50] [2025-09-10 09:30:47] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-10 09:30:50] [2025-09-10 09:30:49] [OK] Google Sheets оновлено!
[2025-09-10 09:30:50] [2025-09-10 09:30:50] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-09-10 09:30:50] [2025-09-10 09:30:50] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-10 09:30:50] [2025-09-10 09:30:50] [OK] Обробка завершена!
[2025-09-10 09:30:50] [TIME] Час виконання скрипта sync_умови_рівень.py: 4.15 сек.
[2025-09-10 09:30:50] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-10 09:31:25] [INFO] Виконуємо SQL-запит...
[2025-09-10 09:31:25] [OK] Отримано 40690 рядків
[2025-09-10 09:31:25] [OK] Дублікатів за ключовими полями немає.
[2025-09-10 09:31:25] [DELETE] Очищення старих записів...
[2025-09-10 09:31:25] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-09-10 09:31:25] [OK] Дані успішно завантажені!
[2025-09-10 09:31:25] [TIME] Час виконання скрипта zp_sales_salary_new.py: 34.89 сек.
[2025-09-10 09:31:25] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-09-10 09:31:29] [SYNC] Розпочато обробку змін...
[2025-09-10 09:31:29] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-09-10 09:31:29] [OK] Отримано 311 змін для обробки.
[2025-09-10 09:31:29] [FINISH] Обробка завершена: 58 записів премій.
[2025-09-10 09:31:29] [TIME] Час виконання скрипта zp_collective_bonus.py: 3.72 сек.
[2025-09-10 09:31:29] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-09-10 09:31:30] 
[2025-09-10 09:31:30] ===============================
[2025-09-10 09:31:30] Період від 2025-05-01
[2025-09-10 09:31:30] По Стоимость: 345,897.99
[2025-09-10 09:31:30] По СтоимостьБезСкидок: 346,875.64
[2025-09-10 09:31:30] По ВаловийПрибуток: 334,331.86
[2025-09-10 09:31:30] ===============================
[2025-09-10 09:31:30] 
[2025-09-10 09:31:30] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-09-10 09:31:31] [TIME] Час виконання скрипта summary.py: 1.71 сек.
[2025-09-10 09:31:31] [FINISH] Загальний час виконання: 201.5 сек.
================================================================================
[2025-09-10 10:17:51] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-10 10:17:51] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-10 10:17:54] [OK] Отримано 6 записів з Єноту
[2025-09-10 10:17:54] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-10 10:17:54] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-10 10:17:54] [TIME] Час виконання скрипта import_enote_reference.py: 3.94 сек.
[2025-09-10 10:17:54] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-10 10:18:40] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-10 10:18:40] [TIME] Час виконання скрипта auto_fill_idx.py: 45.15 сек.
[2025-09-10 10:18:40] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-10 10:19:29] 
[2025-09-10 10:19:29] [LOG] Початок перевірки графіка — 2025-09-10 10:18:40
[2025-09-10 10:19:29] [LOG] Отримано 31 співробітників з Єнота
[2025-09-10 10:19:29] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-10 10:19:29] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-10 10:19:29] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-10 10:19:29] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 311
[2025-09-10 10:19:29] 
[2025-09-10 10:19:29] [TIME] Час виконання скрипта diagnose_sheets.py: 49.31 сек.
[2025-09-10 10:19:29] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-10 10:19:47] Traceback (most recent call last):
[2025-09-10 10:19:47]   File "/root/Python/ZP/fill_flat_schedule.py", line 217, in <module>
[2025-09-10 10:19:47]     main()
[2025-09-10 10:19:47]   File "/root/Python/ZP/fill_flat_schedule.py", line 35, in main
[2025-09-10 10:19:47]     spreadsheet = client.open(SPREADSHEET_NAME)
[2025-09-10 10:19:47]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 10:19:47]   File "/root/Python/venv/lib/python3.12/site-packages/gspread/client.py", line 157, in open
[2025-09-10 10:19:47]     return Spreadsheet(self.http_client, properties)
[2025-09-10 10:19:47]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 10:19:47]   File "/root/Python/venv/lib/python3.12/site-packages/gspread/spreadsheet.py", line 29, in __init__
[2025-09-10 10:19:47]     metadata = self.fetch_sheet_metadata()
[2025-09-10 10:19:47]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 10:19:47]   File "/root/Python/venv/lib/python3.12/site-packages/gspread/spreadsheet.py", line 230, in fetch_sheet_metadata
[2025-09-10 10:19:47]     return self.client.fetch_sheet_metadata(self.id, params=params)
[2025-09-10 10:19:47]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 10:19:47]   File "/root/Python/venv/lib/python3.12/site-packages/gspread/http_client.py", line 305, in fetch_sheet_metadata
[2025-09-10 10:19:47]     r = self.request("get", url, params=params)
[2025-09-10 10:19:47]         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-10 10:19:47]   File "/root/Python/venv/lib/python3.12/site-packages/gspread/http_client.py", line 128, in request
[2025-09-10 10:19:47]     raise APIError(response)
[2025-09-10 10:19:47] gspread.exceptions.APIError: APIError: [500]: Internal error encountered.
[2025-09-10 10:19:47] [TIME] Час виконання скрипта fill_flat_schedule.py: 17.9 сек.
[2025-09-10 10:19:47] [ERROR] Помилка виконання: fill_flat_schedule.py (exit=1). Зупиняємо.
[2025-09-10 10:19:47] [FINISH] Загальний час виконання: 116.31 сек.
================================================================================
[2025-09-10 11:00:26] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-10 11:00:26] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-10 11:00:30] [OK] Отримано 6 записів з Єноту
[2025-09-10 11:00:30] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-10 11:00:30] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-10 11:00:30] [TIME] Час виконання скрипта import_enote_reference.py: 3.93 сек.
[2025-09-10 11:00:30] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-10 11:01:07] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-10 11:01:07] [TIME] Час виконання скрипта auto_fill_idx.py: 37.2 сек.
[2025-09-10 11:01:07] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-10 11:02:02] 
[2025-09-10 11:02:02] [LOG] Початок перевірки графіка — 2025-09-10 11:01:08
[2025-09-10 11:02:02] [LOG] Отримано 31 співробітників з Єнота
[2025-09-10 11:02:02] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-10 11:02:02] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-10 11:02:02] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-10 11:02:02] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 311
[2025-09-10 11:02:02] 
[2025-09-10 11:02:02] [TIME] Час виконання скрипта diagnose_sheets.py: 54.68 сек.
[2025-09-10 11:02:02] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-10 11:03:12] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-09-10 11:03:12]   tgt_ws.update(
[2025-09-10 11:03:13] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-10 11:03:13] [OK] Таблиця очищена та заголовок додано.
[2025-09-10 11:03:13] [INFO] Формування нових рядків...
[2025-09-10 11:03:13] [OK] Додано 311 актуальних рядків.
[2025-09-10 11:03:13] [INFO] Перевірка на конфлікти...
[2025-09-10 11:03:13] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-10 11:03:13] [INFO] Оновлюємо колонку 'Error'...
[2025-09-10 11:03:13] [INFO] Формуємо перекреслення...
[2025-09-10 11:03:13] 
[2025-09-10 11:03:13] [OK] Конфліктів не знайдено.
[2025-09-10 11:03:13] 
[2025-09-10 11:03:13] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-10 11:03:13] [TIME] Час виконання скрипта fill_flat_schedule.py: 71.49 сек.
[2025-09-10 11:03:13] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-10 11:03:16] [INFO] Нічого не видалено.
[2025-09-10 11:03:16] [OK] Додано: 0, Оновлено: 311, Пропущено: 0
[2025-09-10 11:03:16] [TIME] Час виконання скрипта worktime.py: 2.37 сек.
[2025-09-10 11:03:16] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-10 11:03:36] [START] Скрипт запущено: 2025-09-10 11:03:16
[2025-09-10 11:03:36] [OK] Отримано 25 рядків із Google Sheets.
[2025-09-10 11:03:36] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-10 11:03:36] [OK] Діапазони захищено у Google Sheets.
[2025-09-10 11:03:36] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-10 11:03:36] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-10 11:03:36] [OK] Дані оновлені у Google Sheets.
[2025-09-10 11:03:36] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 25 рядків.
[2025-09-10 11:03:37] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 20.92 сек.
[2025-09-10 11:03:37] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-10 11:03:40] [2025-09-10 11:03:37] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-10 11:03:40] [2025-09-10 11:03:39] [OK] Google Sheets оновлено!
[2025-09-10 11:03:40] [2025-09-10 11:03:40] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-09-10 11:03:40] [2025-09-10 11:03:40] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-10 11:03:40] [2025-09-10 11:03:40] [OK] Обробка завершена!
[2025-09-10 11:03:40] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.4 сек.
[2025-09-10 11:03:40] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-10 11:04:16] [INFO] Виконуємо SQL-запит...
[2025-09-10 11:04:16] [OK] Отримано 40690 рядків
[2025-09-10 11:04:16] [OK] Дублікатів за ключовими полями немає.
[2025-09-10 11:04:16] [DELETE] Очищення старих записів...
[2025-09-10 11:04:16] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-09-10 11:04:16] [OK] Дані успішно завантажені!
[2025-09-10 11:04:16] [TIME] Час виконання скрипта zp_sales_salary_new.py: 35.73 сек.
[2025-09-10 11:04:16] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-09-10 11:04:20] [SYNC] Розпочато обробку змін...
[2025-09-10 11:04:20] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-09-10 11:04:20] [OK] Отримано 311 змін для обробки.
[2025-09-10 11:04:20] [FINISH] Обробка завершена: 58 записів премій.
[2025-09-10 11:04:20] [TIME] Час виконання скрипта zp_collective_bonus.py: 3.94 сек.
[2025-09-10 11:04:20] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-09-10 11:04:21] 
[2025-09-10 11:04:21] ===============================
[2025-09-10 11:04:21] Період від 2025-05-01
[2025-09-10 11:04:21] По Стоимость: 451,397.99
[2025-09-10 11:04:21] По СтоимостьБезСкидок: 452,375.64
[2025-09-10 11:04:21] По ВаловийПрибуток: 439,831.86
[2025-09-10 11:04:21] ===============================
[2025-09-10 11:04:21] 
[2025-09-10 11:04:21] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-09-10 11:04:21] [TIME] Час виконання скрипта summary.py: 1.68 сек.
[2025-09-10 11:04:21] [FINISH] Загальний час виконання: 235.35 сек.
================================================================================
[2025-09-10 11:33:03] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-10 11:33:03] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-10 11:33:07] [OK] Отримано 6 записів з Єноту
[2025-09-10 11:33:07] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-10 11:33:07] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-10 11:33:07] [TIME] Час виконання скрипта import_enote_reference.py: 3.68 сек.
[2025-09-10 11:33:07] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-10 11:33:41] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-10 11:33:41] [TIME] Час виконання скрипта auto_fill_idx.py: 33.78 сек.
[2025-09-10 11:33:41] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-10 11:34:30] 
[2025-09-10 11:34:30] [LOG] Початок перевірки графіка — 2025-09-10 11:33:41
[2025-09-10 11:34:30] [LOG] Отримано 31 співробітників з Єнота
[2025-09-10 11:34:30] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-10 11:34:30] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-10 11:34:30] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-10 11:34:30] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 311
[2025-09-10 11:34:30] 
[2025-09-10 11:34:31] [TIME] Час виконання скрипта diagnose_sheets.py: 49.92 сек.
[2025-09-10 11:34:31] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-10 11:35:51] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-09-10 11:35:51]   tgt_ws.update(
[2025-09-10 11:35:54] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-10 11:35:54] [OK] Таблиця очищена та заголовок додано.
[2025-09-10 11:35:54] [INFO] Формування нових рядків...
[2025-09-10 11:35:54] [OK] Додано 311 актуальних рядків.
[2025-09-10 11:35:54] [INFO] Перевірка на конфлікти...
[2025-09-10 11:35:54] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-10 11:35:54] [INFO] Оновлюємо колонку 'Error'...
[2025-09-10 11:35:54] [INFO] Формуємо перекреслення...
[2025-09-10 11:35:54] 
[2025-09-10 11:35:54] [OK] Конфліктів не знайдено.
[2025-09-10 11:35:54] 
[2025-09-10 11:35:54] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-10 11:35:54] [TIME] Час виконання скрипта fill_flat_schedule.py: 83.46 сек.
[2025-09-10 11:35:54] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-10 11:35:57] [INFO] Нічого не видалено.
[2025-09-10 11:35:57] [OK] Додано: 0, Оновлено: 311, Пропущено: 0
[2025-09-10 11:35:57] [TIME] Час виконання скрипта worktime.py: 3.0 сек.
[2025-09-10 11:35:57] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-10 11:36:21] [START] Скрипт запущено: 2025-09-10 11:35:58
[2025-09-10 11:36:21] [OK] Отримано 25 рядків із Google Sheets.
[2025-09-10 11:36:21] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-10 11:36:21] [OK] Діапазони захищено у Google Sheets.
[2025-09-10 11:36:21] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-10 11:36:21] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-10 11:36:21] [OK] Дані оновлені у Google Sheets.
[2025-09-10 11:36:21] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 25 рядків.
[2025-09-10 11:36:21] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 23.82 сек.
[2025-09-10 11:36:21] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-10 11:36:25] [2025-09-10 11:36:22] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-10 11:36:25] [2025-09-10 11:36:24] [OK] Google Sheets оновлено!
[2025-09-10 11:36:25] [2025-09-10 11:36:24] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-09-10 11:36:25] [2025-09-10 11:36:24] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-10 11:36:25] [2025-09-10 11:36:25] [OK] Обробка завершена!
[2025-09-10 11:36:25] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.95 сек.
[2025-09-10 11:36:25] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-10 11:36:58] [INFO] Виконуємо SQL-запит...
[2025-09-10 11:36:58] [OK] Отримано 40690 рядків
[2025-09-10 11:36:58] [OK] Дублікатів за ключовими полями немає.
[2025-09-10 11:36:58] [DELETE] Очищення старих записів...
[2025-09-10 11:36:58] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-09-10 11:36:58] [OK] Дані успішно завантажені!
[2025-09-10 11:36:58] [TIME] Час виконання скрипта zp_sales_salary_new.py: 33.06 сек.
[2025-09-10 11:36:58] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-09-10 11:37:02] [SYNC] Розпочато обробку змін...
[2025-09-10 11:37:02] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-09-10 11:37:02] [OK] Отримано 311 змін для обробки.
[2025-09-10 11:37:02] [FINISH] Обробка завершена: 58 записів премій.
[2025-09-10 11:37:02] [TIME] Час виконання скрипта zp_collective_bonus.py: 4.19 сек.
[2025-09-10 11:37:02] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-09-10 11:37:04] 
[2025-09-10 11:37:04] ===============================
[2025-09-10 11:37:04] Період від 2025-05-01
[2025-09-10 11:37:04] По Стоимость: 452,052.07
[2025-09-10 11:37:04] По СтоимостьБезСкидок: 453,039.47
[2025-09-10 11:37:04] По ВаловийПрибуток: 440,081.69
[2025-09-10 11:37:04] ===============================
[2025-09-10 11:37:04] 
[2025-09-10 11:37:04] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-09-10 11:37:04] [TIME] Час виконання скрипта summary.py: 1.82 сек.
[2025-09-10 11:37:04] [FINISH] Загальний час виконання: 240.7 сек.
================================================================================
[2025-09-29 17:20:42] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 17:20:42] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 17:20:43] Traceback (most recent call last):
[2025-09-29 17:20:43]   File "/root/Python/ZP/import_enote_reference.py", line 7, in <module>
[2025-09-29 17:20:43]     from google.oauth2.service_account import Credentials
[2025-09-29 17:20:43] ModuleNotFoundError: No module named 'google'
[2025-09-29 17:20:43] [TIME] Час виконання скрипта import_enote_reference.py: 0.79 сек.
[2025-09-29 17:20:43] [ERROR] Помилка виконання: import_enote_reference.py (exit=1). Зупиняємо.
[2025-09-29 17:20:43] [FINISH] Загальний час виконання: 0.79 сек.
================================================================================
[2025-09-29 17:21:49] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 17:21:49] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 17:21:50] Traceback (most recent call last):
[2025-09-29 17:21:50]   File "/root/Python/ZP/import_enote_reference.py", line 7, in <module>
[2025-09-29 17:21:50]     from google.oauth2.service_account import Credentials
[2025-09-29 17:21:50] ModuleNotFoundError: No module named 'google'
[2025-09-29 17:21:50] [TIME] Час виконання скрипта import_enote_reference.py: 0.32 сек.
[2025-09-29 17:21:50] [ERROR] Помилка виконання: import_enote_reference.py (exit=1). Зупиняємо.
[2025-09-29 17:21:50] [FINISH] Загальний час виконання: 0.32 сек.
================================================================================
[2025-09-29 17:24:19] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 17:24:19] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 17:24:22] [OK] Отримано 6 записів з Єноту
[2025-09-29 17:24:22] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-29 17:24:22] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-29 17:24:22] [TIME] Час виконання скрипта import_enote_reference.py: 3.95 сек.
[2025-09-29 17:24:22] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-29 17:24:56] [OK] Оновлено 23 індексів
[2025-09-29 17:24:56] [TIME] Час виконання скрипта auto_fill_idx.py: 33.74 сек.
[2025-09-29 17:24:56] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-29 17:25:51] 
[2025-09-29 17:25:51] [LOG] Початок перевірки графіка — 2025-09-29 17:24:57
[2025-09-29 17:25:51] [LOG] Отримано 31 співробітників з Єнота
[2025-09-29 17:25:51] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-29 17:25:51] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-29 17:25:51] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-29 17:25:51] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-09-29 17:25:51] 
[2025-09-29 17:25:52] [TIME] Час виконання скрипта diagnose_sheets.py: 55.41 сек.
[2025-09-29 17:25:52] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-29 17:26:53] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-09-29 17:26:53]   tgt_ws.update(
[2025-09-29 17:26:56] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-29 17:26:56] [OK] Таблиця очищена та заголовок додано.
[2025-09-29 17:26:56] [INFO] Формування нових рядків...
[2025-09-29 17:26:56] [OK] Додано 304 актуальних рядків.
[2025-09-29 17:26:56] [INFO] Перевірка на конфлікти...
[2025-09-29 17:26:56] [INFO] Виявлено 2 конфлікт(ів)
[2025-09-29 17:26:56] [INFO] Оновлюємо колонку 'Error'...
[2025-09-29 17:26:56] [INFO] Формуємо перекреслення...
[2025-09-29 17:26:56] 
[2025-09-29 17:26:56] [WARN] Знайдені конфлікти:
[2025-09-29 17:26:56] [WARN] Конфлікт: Воробей С. між Фронт (09:00-21:00, 22.09.2025) та Асистент (09:00-21:00, 22.09.2025)
[2025-09-29 17:26:56] [WARN] Конфлікт: Матрьончик М. між Фронт (09:00-21:00, 28.09.2025) та Асистент (09:00-21:00, 28.09.2025)
[2025-09-29 17:26:56] 
[2025-09-29 17:26:56] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-29 17:26:56] [TIME] Час виконання скрипта fill_flat_schedule.py: 64.29 сек.
[2025-09-29 17:26:56] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-29 17:26:59] 🗑 Видалено: 311
[2025-09-29 17:26:59] [OK] Додано: 304, Оновлено: 0, Пропущено: 0
[2025-09-29 17:26:59] [TIME] Час виконання скрипта worktime.py: 3.07 сек.
[2025-09-29 17:26:59] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-29 17:27:17] [START] Скрипт запущено: 2025-09-29 17:27:00
[2025-09-29 17:27:17] [OK] Отримано 25 рядків із Google Sheets.
[2025-09-29 17:27:17] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-29 17:27:17] [OK] Діапазони захищено у Google Sheets.
[2025-09-29 17:27:17] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-29 17:27:17] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-29 17:27:17] [OK] Дані оновлені у Google Sheets.
[2025-09-29 17:27:17] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 25 рядків.
[2025-09-29 17:27:17] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 18.01 сек.
[2025-09-29 17:27:17] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-29 17:27:20] [2025-09-29 17:27:18] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-29 17:27:20] [2025-09-29 17:27:20] [OK] Google Sheets оновлено!
[2025-09-29 17:27:20] [2025-09-29 17:27:20] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-09-29 17:27:20] [2025-09-29 17:27:20] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-29 17:27:20] [2025-09-29 17:27:20] [OK] Обробка завершена!
[2025-09-29 17:27:21] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.58 сек.
[2025-09-29 17:27:21] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-29 17:28:01] [INFO] Виконуємо SQL-запит...
[2025-09-29 17:28:01] [OK] Отримано 45402 рядків
[2025-09-29 17:28:01] [OK] Дублікатів за ключовими полями немає.
[2025-09-29 17:28:01] [DELETE] Очищення старих записів...
[2025-09-29 17:28:01] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-09-29 17:28:01] [OK] Дані успішно завантажені!
[2025-09-29 17:28:01] [TIME] Час виконання скрипта zp_sales_salary_new.py: 40.58 сек.
[2025-09-29 17:28:01] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-09-29 17:28:01] [SYNC] Розпочато обробку змін...
[2025-09-29 17:28:01] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-09-29 17:28:01] [OK] Отримано 0 змін для обробки.
[2025-09-29 17:28:01] [FINISH] Обробка завершена: 0 записів премій.
[2025-09-29 17:28:01] [TIME] Час виконання скрипта zp_collective_bonus.py: 0.25 сек.
[2025-09-29 17:28:01] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-09-29 17:28:02] Traceback (most recent call last):
[2025-09-29 17:28:02]   File "/root/Python/ZP/summary.py", line 75, in <module>
[2025-09-29 17:28:02]     df_worktime['Ставка'] = (df_worktime['СтавкаГодина'] * df_worktime['DurationShift']).round(2)
[2025-09-29 17:28:02]                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-09-29 17:28:02]   File "/root/Python/venv/lib/python3.12/site-packages/pandas/core/series.py", line 2818, in round
[2025-09-29 17:28:02]     raise TypeError("Expected numeric dtype, got object instead.")
[2025-09-29 17:28:02] TypeError: Expected numeric dtype, got object instead.
[2025-09-29 17:28:03] [TIME] Час виконання скрипта summary.py: 1.3 сек.
[2025-09-29 17:28:03] [ERROR] Помилка виконання: summary.py (exit=1). Зупиняємо.
[2025-09-29 17:28:03] [FINISH] Загальний час виконання: 224.18 сек.
================================================================================
[2025-09-29 17:28:44] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 17:28:44] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 17:28:45] Traceback (most recent call last):
[2025-09-29 17:28:45]   File "/root/Python/ZP/import_enote_reference.py", line 7, in <module>
[2025-09-29 17:28:45]     from google.oauth2.service_account import Credentials
[2025-09-29 17:28:45] ModuleNotFoundError: No module named 'google'
[2025-09-29 17:28:45] [TIME] Час виконання скрипта import_enote_reference.py: 0.33 сек.
[2025-09-29 17:28:45] [ERROR] Помилка виконання: import_enote_reference.py (exit=1). Зупиняємо.
[2025-09-29 17:28:45] [FINISH] Загальний час виконання: 0.33 сек.
================================================================================
[2025-09-29 17:28:50] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 17:28:50] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 17:28:51] Traceback (most recent call last):
[2025-09-29 17:28:51]   File "/root/Python/ZP/import_enote_reference.py", line 7, in <module>
[2025-09-29 17:28:51]     from google.oauth2.service_account import Credentials
[2025-09-29 17:28:51] ModuleNotFoundError: No module named 'google'
[2025-09-29 17:28:51] [TIME] Час виконання скрипта import_enote_reference.py: 0.28 сек.
[2025-09-29 17:28:51] [ERROR] Помилка виконання: import_enote_reference.py (exit=1). Зупиняємо.
[2025-09-29 17:28:51] [FINISH] Загальний час виконання: 0.28 сек.
================================================================================
[2025-09-29 17:28:57] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 17:28:57] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 17:28:57] Traceback (most recent call last):
[2025-09-29 17:28:57]   File "/root/Python/ZP/import_enote_reference.py", line 7, in <module>
[2025-09-29 17:28:57]     from google.oauth2.service_account import Credentials
[2025-09-29 17:28:57] ModuleNotFoundError: No module named 'google'
[2025-09-29 17:28:57] [TIME] Час виконання скрипта import_enote_reference.py: 0.32 сек.
[2025-09-29 17:28:57] [ERROR] Помилка виконання: import_enote_reference.py (exit=1). Зупиняємо.
[2025-09-29 17:28:57] [FINISH] Загальний час виконання: 0.32 сек.
================================================================================
[2025-09-29 17:29:14] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 17:29:14] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 17:29:14] Traceback (most recent call last):
[2025-09-29 17:29:14]   File "/root/Python/ZP/import_enote_reference.py", line 7, in <module>
[2025-09-29 17:29:14]     from google.oauth2.service_account import Credentials
[2025-09-29 17:29:14] ModuleNotFoundError: No module named 'google'
[2025-09-29 17:29:14] [TIME] Час виконання скрипта import_enote_reference.py: 0.34 сек.
[2025-09-29 17:29:14] [ERROR] Помилка виконання: import_enote_reference.py (exit=1). Зупиняємо.
[2025-09-29 17:29:14] [FINISH] Загальний час виконання: 0.34 сек.
================================================================================
[2025-09-29 17:32:59] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 17:32:59] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 17:33:00] Traceback (most recent call last):
[2025-09-29 17:33:00]   File "/root/Python/ZP/import_enote_reference.py", line 7, in <module>
[2025-09-29 17:33:00]     from google.oauth2.service_account import Credentials
[2025-09-29 17:33:00] ModuleNotFoundError: No module named 'google'
[2025-09-29 17:33:00] [TIME] Час виконання скрипта import_enote_reference.py: 0.36 сек.
[2025-09-29 17:33:00] [ERROR] Помилка виконання: import_enote_reference.py (exit=1). Зупиняємо.
[2025-09-29 17:33:00] [FINISH] Загальний час виконання: 0.36 сек.
================================================================================
[2025-09-29 17:34:50] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 17:34:50] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 17:34:51] Traceback (most recent call last):
[2025-09-29 17:34:51]   File "/root/Python/ZP/import_enote_reference.py", line 7, in <module>
[2025-09-29 17:34:51]     from google.oauth2.service_account import Credentials
[2025-09-29 17:34:51] ModuleNotFoundError: No module named 'google'
[2025-09-29 17:34:51] [TIME] Час виконання скрипта import_enote_reference.py: 0.32 сек.
[2025-09-29 17:34:51] [ERROR] Помилка виконання: import_enote_reference.py (exit=1). Зупиняємо.
[2025-09-29 17:34:51] [FINISH] Загальний час виконання: 0.32 сек.
================================================================================
[2025-09-29 17:36:33] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 17:36:33] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 17:36:34] Traceback (most recent call last):
[2025-09-29 17:36:34]   File "/root/Python/ZP/import_enote_reference.py", line 7, in <module>
[2025-09-29 17:36:34]     from google.oauth2.service_account import Credentials
[2025-09-29 17:36:34] ModuleNotFoundError: No module named 'google'
[2025-09-29 17:36:34] [TIME] Час виконання скрипта import_enote_reference.py: 0.35 сек.
[2025-09-29 17:36:34] [ERROR] Помилка виконання: import_enote_reference.py (exit=1). Зупиняємо.
[2025-09-29 17:36:34] [FINISH] Загальний час виконання: 0.35 сек.
================================================================================
[2025-09-29 18:01:15] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 18:01:15] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 18:01:16] Traceback (most recent call last):
[2025-09-29 18:01:16]   File "/root/Python/ZP/import_enote_reference.py", line 7, in <module>
[2025-09-29 18:01:16]     from google.oauth2.service_account import Credentials
[2025-09-29 18:01:16] ModuleNotFoundError: No module named 'google'
[2025-09-29 18:01:16] [TIME] Час виконання скрипта import_enote_reference.py: 0.32 сек.
[2025-09-29 18:01:16] [ERROR] Помилка виконання: import_enote_reference.py (exit=1). Зупиняємо.
[2025-09-29 18:01:16] [FINISH] Загальний час виконання: 0.32 сек.
================================================================================
[2025-09-29 18:02:06] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 18:02:06] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 18:02:10] [OK] Отримано 6 записів з Єноту
[2025-09-29 18:02:10] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-29 18:02:10] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-29 18:02:10] [TIME] Час виконання скрипта import_enote_reference.py: 4.19 сек.
[2025-09-29 18:02:10] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-29 18:02:42] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-29 18:02:42] [TIME] Час виконання скрипта auto_fill_idx.py: 31.87 сек.
[2025-09-29 18:02:42] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-29 18:03:29] 
[2025-09-29 18:03:29] [LOG] Початок перевірки графіка — 2025-09-29 18:02:42
[2025-09-29 18:03:29] [LOG] Отримано 31 співробітників з Єнота
[2025-09-29 18:03:29] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-29 18:03:29] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-29 18:03:29] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-29 18:03:29] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-09-29 18:03:29] 
[2025-09-29 18:03:29] [TIME] Час виконання скрипта diagnose_sheets.py: 47.84 сек.
[2025-09-29 18:03:29] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-29 18:04:35] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-09-29 18:04:35]   tgt_ws.update(
[2025-09-29 18:04:37] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-29 18:04:37] [OK] Таблиця очищена та заголовок додано.
[2025-09-29 18:04:37] [INFO] Формування нових рядків...
[2025-09-29 18:04:37] [OK] Додано 304 актуальних рядків.
[2025-09-29 18:04:37] [INFO] Перевірка на конфлікти...
[2025-09-29 18:04:37] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-29 18:04:37] [INFO] Оновлюємо колонку 'Error'...
[2025-09-29 18:04:37] [INFO] Формуємо перекреслення...
[2025-09-29 18:04:37] 
[2025-09-29 18:04:37] [OK] Конфліктів не знайдено.
[2025-09-29 18:04:37] 
[2025-09-29 18:04:37] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-29 18:04:37] [TIME] Час виконання скрипта fill_flat_schedule.py: 67.84 сек.
[2025-09-29 18:04:37] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-29 18:04:40] [INFO] Нічого не видалено.
[2025-09-29 18:04:40] [OK] Додано: 304, Оновлено: 0, Пропущено: 0
[2025-09-29 18:04:41] [TIME] Час виконання скрипта worktime.py: 3.28 сек.
[2025-09-29 18:04:41] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-29 18:05:00] [START] Скрипт запущено: 2025-09-29 18:04:41
[2025-09-29 18:05:00] [OK] Отримано 25 рядків із Google Sheets.
[2025-09-29 18:05:00] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-29 18:05:00] [OK] Діапазони захищено у Google Sheets.
[2025-09-29 18:05:00] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-29 18:05:00] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-29 18:05:00] [OK] Дані оновлені у Google Sheets.
[2025-09-29 18:05:00] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 25 рядків.
[2025-09-29 18:05:00] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 19.84 сек.
[2025-09-29 18:05:00] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-29 18:05:05] [2025-09-29 18:05:01] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-29 18:05:05] [2025-09-29 18:05:04] [OK] Google Sheets оновлено!
[2025-09-29 18:05:05] [2025-09-29 18:05:04] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-09-29 18:05:05] [2025-09-29 18:05:04] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-29 18:05:05] [2025-09-29 18:05:05] [OK] Обробка завершена!
[2025-09-29 18:05:05] [TIME] Час виконання скрипта sync_умови_рівень.py: 4.58 сек.
[2025-09-29 18:05:05] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-29 18:05:48] [INFO] Виконуємо SQL-запит...
[2025-09-29 18:05:48] [OK] Отримано 45402 рядків
[2025-09-29 18:05:48] [OK] Дублікатів за ключовими полями немає.
[2025-09-29 18:05:48] [DELETE] Очищення старих записів...
[2025-09-29 18:05:48] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-09-29 18:05:48] [OK] Дані успішно завантажені!
[2025-09-29 18:05:49] [TIME] Час виконання скрипта zp_sales_salary_new.py: 43.55 сек.
[2025-09-29 18:05:49] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-09-29 18:05:49] [SYNC] Розпочато обробку змін...
[2025-09-29 18:05:49] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-09-29 18:05:49] [OK] Отримано 304 змін для обробки.
[2025-09-29 18:05:49] [FINISH] Обробка завершена: 0 записів премій.
[2025-09-29 18:05:49] [TIME] Час виконання скрипта zp_collective_bonus.py: 0.72 сек.
[2025-09-29 18:05:49] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-09-29 18:05:51] 
[2025-09-29 18:05:51] ===============================
[2025-09-29 18:05:51] Період від 2025-05-01
[2025-09-29 18:05:51] По Стоимость: 386,079.34
[2025-09-29 18:05:51] По СтоимостьБезСкидок: 386,507.58
[2025-09-29 18:05:51] По ВаловийПрибуток: 384,096.02
[2025-09-29 18:05:51] ===============================
[2025-09-29 18:05:51] 
[2025-09-29 18:05:51] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-09-29 18:05:51] [TIME] Час виконання скрипта summary.py: 1.67 сек.
[2025-09-29 18:05:51] [FINISH] Загальний час виконання: 225.38 сек.
================================================================================
[2025-09-29 18:10:13] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 18:10:13] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 18:10:14] Traceback (most recent call last):
[2025-09-29 18:10:14]   File "/root/Python/ZP/import_enote_reference.py", line 7, in <module>
[2025-09-29 18:10:14]     from google.oauth2.service_account import Credentials
[2025-09-29 18:10:14] ModuleNotFoundError: No module named 'google'
[2025-09-29 18:10:14] [TIME] Час виконання скрипта import_enote_reference.py: 0.36 сек.
[2025-09-29 18:10:14] [ERROR] Помилка виконання: import_enote_reference.py (exit=1). Зупиняємо.
[2025-09-29 18:10:14] [FINISH] Загальний час виконання: 0.36 сек.
================================================================================
[2025-09-29 18:10:32] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 18:10:32] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 18:10:35] [OK] Отримано 6 записів з Єноту
[2025-09-29 18:10:35] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-29 18:10:35] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-29 18:10:35] [TIME] Час виконання скрипта import_enote_reference.py: 3.17 сек.
[2025-09-29 18:10:35] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-29 18:11:01] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-29 18:11:01] [TIME] Час виконання скрипта auto_fill_idx.py: 26.67 сек.
[2025-09-29 18:11:01] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-29 18:11:49] 
[2025-09-29 18:11:49] [LOG] Початок перевірки графіка — 2025-09-29 18:11:02
[2025-09-29 18:11:49] [LOG] Отримано 31 співробітників з Єнота
[2025-09-29 18:11:49] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-29 18:11:49] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-29 18:11:49] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-29 18:11:49] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-09-29 18:11:49] 
[2025-09-29 18:11:49] [TIME] Час виконання скрипта diagnose_sheets.py: 47.65 сек.
[2025-09-29 18:11:49] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-29 18:12:49] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-09-29 18:12:49]   tgt_ws.update(
[2025-09-29 18:12:52] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-29 18:12:52] [OK] Таблиця очищена та заголовок додано.
[2025-09-29 18:12:52] [INFO] Формування нових рядків...
[2025-09-29 18:12:52] [OK] Додано 304 актуальних рядків.
[2025-09-29 18:12:52] [INFO] Перевірка на конфлікти...
[2025-09-29 18:12:52] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-29 18:12:52] [INFO] Оновлюємо колонку 'Error'...
[2025-09-29 18:12:52] [INFO] Формуємо перекреслення...
[2025-09-29 18:12:52] 
[2025-09-29 18:12:52] [OK] Конфліктів не знайдено.
[2025-09-29 18:12:52] 
[2025-09-29 18:12:52] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-29 18:12:52] [TIME] Час виконання скрипта fill_flat_schedule.py: 62.92 сек.
[2025-09-29 18:12:52] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-29 18:12:55] [INFO] Нічого не видалено.
[2025-09-29 18:12:55] [OK] Додано: 0, Оновлено: 304, Пропущено: 0
[2025-09-29 18:12:55] [TIME] Час виконання скрипта worktime.py: 3.18 сек.
[2025-09-29 18:12:55] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-29 18:13:15] [START] Скрипт запущено: 2025-09-29 18:12:56
[2025-09-29 18:13:15] [OK] Отримано 25 рядків із Google Sheets.
[2025-09-29 18:13:15] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-29 18:13:15] [OK] Діапазони захищено у Google Sheets.
[2025-09-29 18:13:15] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-29 18:13:15] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-29 18:13:15] [OK] Дані оновлені у Google Sheets.
[2025-09-29 18:13:15] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 25 рядків.
[2025-09-29 18:13:15] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 20.16 сек.
[2025-09-29 18:13:15] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-29 18:13:19] [2025-09-29 18:13:16] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-29 18:13:19] [2025-09-29 18:13:18] [OK] Google Sheets оновлено!
[2025-09-29 18:13:19] [2025-09-29 18:13:18] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-09-29 18:13:19] [2025-09-29 18:13:18] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-29 18:13:19] [2025-09-29 18:13:19] [OK] Обробка завершена!
[2025-09-29 18:13:19] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.53 сек.
[2025-09-29 18:13:19] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-29 18:14:01] [INFO] Виконуємо SQL-запит...
[2025-09-29 18:14:01] [OK] Отримано 45402 рядків
[2025-09-29 18:14:01] [OK] Дублікатів за ключовими полями немає.
[2025-09-29 18:14:01] [DELETE] Очищення старих записів...
[2025-09-29 18:14:01] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-09-29 18:14:01] [OK] Дані успішно завантажені!
[2025-09-29 18:14:02] [TIME] Час виконання скрипта zp_sales_salary_new.py: 42.68 сек.
[2025-09-29 18:14:02] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-09-29 18:14:06] [SYNC] Розпочато обробку змін...
[2025-09-29 18:14:06] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-09-29 18:14:06] [OK] Отримано 304 змін для обробки.
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-24 idx=Фрн_1
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Послуги у зміні 2025-09-24 idx=Фрн_1
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-25 idx=Фрн_1
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Послуги у зміні 2025-09-25 idx=Фрн_1
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-26 idx=Фрн_1
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Послуги у зміні 2025-09-26 idx=Фрн_1
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-27 idx=Фрн_1
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Послуги у зміні 2025-09-27 idx=Фрн_1
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-28 idx=Фрн_1
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Послуги у зміні 2025-09-28 idx=Фрн_1
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-28 idx=Фрн_2
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Послуги у зміні 2025-09-28 idx=Фрн_2
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-29 idx=Фрн_1
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Послуги у зміні 2025-09-29 idx=Фрн_1
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-30 idx=Фрн_1
[2025-09-29 18:14:06] [WARN] Немає продажів для правила Послуги у зміні 2025-09-30 idx=Фрн_1
[2025-09-29 18:14:06] [FINISH] Обробка завершена: 50 записів премій.
[2025-09-29 18:14:06] [TIME] Час виконання скрипта zp_collective_bonus.py: 4.67 сек.
[2025-09-29 18:14:06] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-09-29 18:14:08] 
[2025-09-29 18:14:08] ===============================
[2025-09-29 18:14:08] Період від 2025-05-01
[2025-09-29 18:14:08] По Стоимость: 434,211.42
[2025-09-29 18:14:08] По СтоимостьБезСкидок: 435,427.79
[2025-09-29 18:14:08] По ВаловийПрибуток: 424,592.64
[2025-09-29 18:14:08] ===============================
[2025-09-29 18:14:08] 
[2025-09-29 18:14:08] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-09-29 18:14:08] [TIME] Час виконання скрипта summary.py: 1.86 сек.
[2025-09-29 18:14:08] [FINISH] Загальний час виконання: 216.49 сек.
================================================================================
[2025-09-29 18:17:08] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-29 18:17:08] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-29 18:17:12] [OK] Отримано 6 записів з Єноту
[2025-09-29 18:17:12] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-29 18:17:12] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-29 18:17:12] [TIME] Час виконання скрипта import_enote_reference.py: 4.09 сек.
[2025-09-29 18:17:12] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-29 18:17:39] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-29 18:17:39] [TIME] Час виконання скрипта auto_fill_idx.py: 27.62 сек.
[2025-09-29 18:17:39] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-29 18:18:22] 
[2025-09-29 18:18:22] [LOG] Початок перевірки графіка — 2025-09-29 18:17:40
[2025-09-29 18:18:22] [LOG] Отримано 31 співробітників з Єнота
[2025-09-29 18:18:22] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-29 18:18:22] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-29 18:18:22] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-29 18:18:22] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-09-29 18:18:22] 
[2025-09-29 18:18:22] [TIME] Час виконання скрипта diagnose_sheets.py: 42.83 сек.
[2025-09-29 18:18:22] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-29 18:19:21] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-09-29 18:19:21]   tgt_ws.update(
[2025-09-29 18:19:23] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-29 18:19:23] [OK] Таблиця очищена та заголовок додано.
[2025-09-29 18:19:23] [INFO] Формування нових рядків...
[2025-09-29 18:19:23] [OK] Додано 304 актуальних рядків.
[2025-09-29 18:19:23] [INFO] Перевірка на конфлікти...
[2025-09-29 18:19:23] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-29 18:19:23] [INFO] Оновлюємо колонку 'Error'...
[2025-09-29 18:19:23] [INFO] Формуємо перекреслення...
[2025-09-29 18:19:23] 
[2025-09-29 18:19:23] [OK] Конфліктів не знайдено.
[2025-09-29 18:19:23] 
[2025-09-29 18:19:23] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-29 18:19:23] [TIME] Час виконання скрипта fill_flat_schedule.py: 60.63 сек.
[2025-09-29 18:19:23] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-29 18:19:25] [INFO] Нічого не видалено.
[2025-09-29 18:19:25] [OK] Додано: 0, Оновлено: 304, Пропущено: 0
[2025-09-29 18:19:26] [TIME] Час виконання скрипта worktime.py: 2.95 сек.
[2025-09-29 18:19:26] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-29 18:19:45] [START] Скрипт запущено: 2025-09-29 18:19:26
[2025-09-29 18:19:45] [OK] Отримано 26 рядків із Google Sheets.
[2025-09-29 18:19:45] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-29 18:19:45] [OK] Діапазони захищено у Google Sheets.
[2025-09-29 18:19:45] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-29 18:19:45] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-29 18:19:45] [OK] Дані оновлені у Google Sheets.
[2025-09-29 18:19:45] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 26 рядків.
[2025-09-29 18:19:45] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 19.09 сек.
[2025-09-29 18:19:45] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-29 18:19:49] [2025-09-29 18:19:46] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-29 18:19:49] [2025-09-29 18:19:48] [OK] Google Sheets оновлено!
[2025-09-29 18:19:49] [2025-09-29 18:19:48] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-09-29 18:19:49] [2025-09-29 18:19:48] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-29 18:19:49] [2025-09-29 18:19:49] [OK] Обробка завершена!
[2025-09-29 18:19:49] [TIME] Час виконання скрипта sync_умови_рівень.py: 4.33 сек.
[2025-09-29 18:19:49] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-29 18:20:32] [INFO] Виконуємо SQL-запит...
[2025-09-29 18:20:32] [OK] Отримано 45402 рядків
[2025-09-29 18:20:32] [OK] Дублікатів за ключовими полями немає.
[2025-09-29 18:20:32] [DELETE] Очищення старих записів...
[2025-09-29 18:20:32] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-09-29 18:20:32] [OK] Дані успішно завантажені!
[2025-09-29 18:20:32] [TIME] Час виконання скрипта zp_sales_salary_new.py: 42.79 сек.
[2025-09-29 18:20:32] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-09-29 18:20:37] [SYNC] Розпочато обробку змін...
[2025-09-29 18:20:37] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-09-29 18:20:37] [OK] Отримано 304 змін для обробки.
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-24 idx=Фрн_1
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Послуги у зміні 2025-09-24 idx=Фрн_1
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-25 idx=Фрн_1
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Послуги у зміні 2025-09-25 idx=Фрн_1
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-26 idx=Фрн_1
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Послуги у зміні 2025-09-26 idx=Фрн_1
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-27 idx=Фрн_1
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Послуги у зміні 2025-09-27 idx=Фрн_1
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-28 idx=Фрн_1
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Послуги у зміні 2025-09-28 idx=Фрн_1
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-28 idx=Фрн_2
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Послуги у зміні 2025-09-28 idx=Фрн_2
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-29 idx=Фрн_1
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Послуги у зміні 2025-09-29 idx=Фрн_1
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-30 idx=Фрн_1
[2025-09-29 18:20:37] [WARN] Немає продажів для правила Послуги у зміні 2025-09-30 idx=Фрн_1
[2025-09-29 18:20:37] [FINISH] Обробка завершена: 50 записів премій.
[2025-09-29 18:20:37] [TIME] Час виконання скрипта zp_collective_bonus.py: 4.81 сек.
[2025-09-29 18:20:37] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-09-29 18:20:38] 
[2025-09-29 18:20:38] ===============================
[2025-09-29 18:20:38] Період від 2025-05-01
[2025-09-29 18:20:38] По Стоимость: 437,211.42
[2025-09-29 18:20:38] По СтоимостьБезСкидок: 438,427.79
[2025-09-29 18:20:38] По ВаловийПрибуток: 427,592.64
[2025-09-29 18:20:38] ===============================
[2025-09-29 18:20:38] 
[2025-09-29 18:20:38] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-09-29 18:20:39] [TIME] Час виконання скрипта summary.py: 1.84 сек.
[2025-09-29 18:20:39] [FINISH] Загальний час виконання: 211.0 сек.
================================================================================
[2025-09-30 05:13:30] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-09-30 05:13:30] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-09-30 05:13:35] [OK] Отримано 6 записів з Єноту
[2025-09-30 05:13:35] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-09-30 05:13:35] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-09-30 05:13:35] [TIME] Час виконання скрипта import_enote_reference.py: 4.53 сек.
[2025-09-30 05:13:35] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-09-30 05:13:58] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-09-30 05:13:58] [TIME] Час виконання скрипта auto_fill_idx.py: 23.5 сек.
[2025-09-30 05:13:58] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-09-30 05:14:35] 
[2025-09-30 05:14:35] [LOG] Початок перевірки графіка — 2025-09-30 05:13:59
[2025-09-30 05:14:35] [LOG] Отримано 31 співробітників з Єнота
[2025-09-30 05:14:35] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-09-30 05:14:35] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-09-30 05:14:35] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-09-30 05:14:35] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-09-30 05:14:35] 
[2025-09-30 05:14:35] [TIME] Час виконання скрипта diagnose_sheets.py: 36.93 сек.
[2025-09-30 05:14:35] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-09-30 05:15:20] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-09-30 05:15:20]   tgt_ws.update(
[2025-09-30 05:15:21] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-09-30 05:15:21] [OK] Таблиця очищена та заголовок додано.
[2025-09-30 05:15:21] [INFO] Формування нових рядків...
[2025-09-30 05:15:21] [OK] Додано 304 актуальних рядків.
[2025-09-30 05:15:21] [INFO] Перевірка на конфлікти...
[2025-09-30 05:15:21] [INFO] Виявлено 0 конфлікт(ів)
[2025-09-30 05:15:21] [INFO] Оновлюємо колонку 'Error'...
[2025-09-30 05:15:21] [INFO] Формуємо перекреслення...
[2025-09-30 05:15:21] 
[2025-09-30 05:15:21] [OK] Конфліктів не знайдено.
[2025-09-30 05:15:21] 
[2025-09-30 05:15:21] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-09-30 05:15:21] [TIME] Час виконання скрипта fill_flat_schedule.py: 45.55 сек.
[2025-09-30 05:15:21] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-09-30 05:15:23] [INFO] Нічого не видалено.
[2025-09-30 05:15:23] [OK] Додано: 0, Оновлено: 304, Пропущено: 0
[2025-09-30 05:15:24] [TIME] Час виконання скрипта worktime.py: 2.93 сек.
[2025-09-30 05:15:24] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-09-30 05:15:37] [START] Скрипт запущено: 2025-09-30 05:15:24
[2025-09-30 05:15:37] [OK] Отримано 26 рядків із Google Sheets.
[2025-09-30 05:15:37] [OK] Колонка ID оновлена у Google Sheets.
[2025-09-30 05:15:37] [OK] Діапазони захищено у Google Sheets.
[2025-09-30 05:15:37] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-09-30 05:15:37] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-09-30 05:15:37] [OK] Дані оновлені у Google Sheets.
[2025-09-30 05:15:37] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 26 рядків.
[2025-09-30 05:15:38] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 13.9 сек.
[2025-09-30 05:15:38] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-09-30 05:15:40] [2025-09-30 05:15:38] [SYNC] Початок синхронізації рівнів співробітників...
[2025-09-30 05:15:40] [2025-09-30 05:15:40] [OK] Google Sheets оновлено!
[2025-09-30 05:15:40] [2025-09-30 05:15:40] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-09-30 05:15:40] [2025-09-30 05:15:40] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-09-30 05:15:40] [2025-09-30 05:15:40] [OK] Обробка завершена!
[2025-09-30 05:15:40] [TIME] Час виконання скрипта sync_умови_рівень.py: 2.66 сек.
[2025-09-30 05:15:40] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-09-30 05:16:19] [INFO] Виконуємо SQL-запит...
[2025-09-30 05:16:19] [OK] Отримано 45402 рядків
[2025-09-30 05:16:19] [OK] Дублікатів за ключовими полями немає.
[2025-09-30 05:16:19] [DELETE] Очищення старих записів...
[2025-09-30 05:16:19] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-09-30 05:16:19] [OK] Дані успішно завантажені!
[2025-09-30 05:16:20] [TIME] Час виконання скрипта zp_sales_salary_new.py: 39.43 сек.
[2025-09-30 05:16:20] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-09-30 05:16:24] [SYNC] Розпочато обробку змін...
[2025-09-30 05:16:24] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-09-30 05:16:24] [OK] Отримано 304 змін для обробки.
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-24 idx=Фрн_1
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Послуги у зміні 2025-09-24 idx=Фрн_1
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-25 idx=Фрн_1
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Послуги у зміні 2025-09-25 idx=Фрн_1
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-26 idx=Фрн_1
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Послуги у зміні 2025-09-26 idx=Фрн_1
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-27 idx=Фрн_1
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Послуги у зміні 2025-09-27 idx=Фрн_1
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-28 idx=Фрн_1
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Послуги у зміні 2025-09-28 idx=Фрн_1
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-28 idx=Фрн_2
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Послуги у зміні 2025-09-28 idx=Фрн_2
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-29 idx=Фрн_1
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Послуги у зміні 2025-09-29 idx=Фрн_1
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Зоомагазин у зміні 2025-09-30 idx=Фрн_1
[2025-09-30 05:16:24] [WARN] Немає продажів для правила Послуги у зміні 2025-09-30 idx=Фрн_1
[2025-09-30 05:16:24] [FINISH] Обробка завершена: 50 записів премій.
[2025-09-30 05:16:24] [TIME] Час виконання скрипта zp_collective_bonus.py: 4.41 сек.
[2025-09-30 05:16:24] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-09-30 05:16:25] 
[2025-09-30 05:16:25] ===============================
[2025-09-30 05:16:25] Період від 2025-05-01
[2025-09-30 05:16:25] По Стоимость: 437,211.42
[2025-09-30 05:16:25] По СтоимостьБезСкидок: 438,427.79
[2025-09-30 05:16:25] По ВаловийПрибуток: 427,592.64
[2025-09-30 05:16:25] ===============================
[2025-09-30 05:16:25] 
[2025-09-30 05:16:25] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-09-30 05:16:26] [TIME] Час виконання скрипта summary.py: 1.63 сек.
[2025-09-30 05:16:26] [FINISH] Загальний час виконання: 175.48 сек.
================================================================================
[2025-10-04 03:34:50] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 03:34:50] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-10-04 03:34:50] Traceback (most recent call last):
[2025-10-04 03:34:50]   File "/root/Python/ZP/import_enote_reference.py", line 7, in <module>
[2025-10-04 03:34:50]     from google.oauth2.service_account import Credentials
[2025-10-04 03:34:50] ModuleNotFoundError: No module named 'google'
[2025-10-04 03:34:50] [TIME] Час виконання скрипта import_enote_reference.py: 0.55 сек.
[2025-10-04 03:34:50] [ERROR] Помилка виконання: import_enote_reference.py (exit=1). Зупиняємо.
[2025-10-04 03:34:50] [FINISH] Загальний час виконання: 0.55 сек.
================================================================================
[2025-10-04 03:41:35] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 03:41:35] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-10-04 03:41:35] Traceback (most recent call last):
[2025-10-04 03:41:35]   File "/root/Python/ZP/import_enote_reference.py", line 5, in <module>
[2025-10-04 03:41:35]     import requests
[2025-10-04 03:41:35] ModuleNotFoundError: No module named 'requests'
[2025-10-04 03:41:35] [TIME] Час виконання скрипта import_enote_reference.py: 0.08 сек.
[2025-10-04 03:41:35] [ERROR] Помилка виконання: import_enote_reference.py (exit=1). Зупиняємо.
[2025-10-04 03:41:35] [FINISH] Загальний час виконання: 0.08 сек.
================================================================================
[2025-10-04 03:44:26] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 03:44:26] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-10-04 03:44:30] [OK] Отримано 6 записів з Єноту
[2025-10-04 03:44:30] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-10-04 03:44:30] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-10-04 03:44:30] [TIME] Час виконання скрипта import_enote_reference.py: 4.18 сек.
[2025-10-04 03:44:30] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-10-04 03:44:55] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-10-04 03:44:56] [TIME] Час виконання скрипта auto_fill_idx.py: 25.29 сек.
[2025-10-04 03:44:56] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-10-04 03:45:35] 
[2025-10-04 03:45:35] [LOG] Початок перевірки графіка — 2025-10-04 03:44:56
[2025-10-04 03:45:35] [LOG] Отримано 31 співробітників з Єнота
[2025-10-04 03:45:35] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-10-04 03:45:35] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-10-04 03:45:35] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-10-04 03:45:35] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-10-04 03:45:35] 
[2025-10-04 03:45:35] [TIME] Час виконання скрипта diagnose_sheets.py: 39.26 сек.
[2025-10-04 03:45:35] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-10-04 03:46:24] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-10-04 03:46:24]   tgt_ws.update(
[2025-10-04 03:46:26] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-10-04 03:46:26] [OK] Таблиця очищена та заголовок додано.
[2025-10-04 03:46:26] [INFO] Формування нових рядків...
[2025-10-04 03:46:26] [OK] Додано 304 актуальних рядків.
[2025-10-04 03:46:26] [INFO] Перевірка на конфлікти...
[2025-10-04 03:46:26] [INFO] Виявлено 0 конфлікт(ів)
[2025-10-04 03:46:26] [INFO] Оновлюємо колонку 'Error'...
[2025-10-04 03:46:26] [INFO] Формуємо перекреслення...
[2025-10-04 03:46:26] 
[2025-10-04 03:46:26] [OK] Конфліктів не знайдено.
[2025-10-04 03:46:26] 
[2025-10-04 03:46:26] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-10-04 03:46:26] [TIME] Час виконання скрипта fill_flat_schedule.py: 50.87 сек.
[2025-10-04 03:46:26] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-10-04 03:46:28] [INFO] Нічого не видалено.
[2025-10-04 03:46:28] [OK] Додано: 0, Оновлено: 304, Пропущено: 0
[2025-10-04 03:46:29] [TIME] Час виконання скрипта worktime.py: 2.98 сек.
[2025-10-04 03:46:29] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-10-04 03:46:45] [START] Скрипт запущено: 2025-10-04 03:46:30
[2025-10-04 03:46:45] [OK] Отримано 26 рядків із Google Sheets.
[2025-10-04 03:46:45] [OK] Колонка ID оновлена у Google Sheets.
[2025-10-04 03:46:45] [OK] Діапазони захищено у Google Sheets.
[2025-10-04 03:46:45] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-10-04 03:46:45] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-10-04 03:46:45] [OK] Дані оновлені у Google Sheets.
[2025-10-04 03:46:45] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 26 рядків.
[2025-10-04 03:46:45] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 16.04 сек.
[2025-10-04 03:46:45] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-10-04 03:46:48] [2025-10-04 03:46:45] [SYNC] Початок синхронізації рівнів співробітників...
[2025-10-04 03:46:48] [2025-10-04 03:46:48] [OK] Google Sheets оновлено!
[2025-10-04 03:46:48] [2025-10-04 03:46:48] [OK] Завантажено: 0 додано, 0 оновлено.
[2025-10-04 03:46:48] [2025-10-04 03:46:48] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-10-04 03:46:48] [2025-10-04 03:46:48] [OK] Обробка завершена!
[2025-10-04 03:46:48] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.77 сек.
[2025-10-04 03:46:48] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-10-04 03:47:31] [INFO] Виконуємо SQL-запит...
[2025-10-04 03:47:31] [OK] Отримано 48392 рядків
[2025-10-04 03:47:31] [OK] Дублікатів за ключовими полями немає.
[2025-10-04 03:47:31] [DELETE] Очищення старих записів...
[2025-10-04 03:47:31] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-10-04 03:47:31] [OK] Дані успішно завантажені!
[2025-10-04 03:47:32] [TIME] Час виконання скрипта zp_sales_salary_new.py: 43.36 сек.
[2025-10-04 03:47:32] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-10-04 03:47:37] [SYNC] Розпочато обробку змін...
[2025-10-04 03:47:37] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-10-04 03:47:37] [OK] Отримано 304 змін для обробки.
[2025-10-04 03:47:37] [FINISH] Обробка завершена: 66 записів премій.
[2025-10-04 03:47:37] [TIME] Час виконання скрипта zp_collective_bonus.py: 5.32 сек.
[2025-10-04 03:47:37] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-10-04 03:47:39] 
[2025-10-04 03:47:39] ===============================
[2025-10-04 03:47:39] Період від 2025-05-01
[2025-10-04 03:47:39] По Стоимость: 445,392.87
[2025-10-04 03:47:39] По СтоимостьБезСкидок: 446,980.90
[2025-10-04 03:47:39] По ВаловийПрибуток: 434,143.42
[2025-10-04 03:47:39] ===============================
[2025-10-04 03:47:39] 
[2025-10-04 03:47:39] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-10-04 03:47:39] [TIME] Час виконання скрипта summary.py: 1.98 сек.
[2025-10-04 03:47:39] [FINISH] Загальний час виконання: 193.06 сек.
================================================================================
[2025-10-04 05:41:18] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 05:41:18] 
[RUN] Виконую скрипт: truncate_zp_tables.py
------------------------------------------------------------
[2025-10-04 05:41:18] Traceback (most recent call last):
[2025-10-04 05:41:18]   File "/root/Python/ZP/truncate_zp_tables.py", line 16, in <module>
[2025-10-04 05:41:18]     import mysql.connector
[2025-10-04 05:41:18] ModuleNotFoundError: No module named 'mysql'
[2025-10-04 05:41:18] [TIME] Час виконання скрипта truncate_zp_tables.py: 0.03 сек.
[2025-10-04 05:41:18] [ERROR] Помилка виконання: truncate_zp_tables.py (exit=1). Зупиняємо.
[2025-10-04 05:41:18] [FINISH] Загальний час виконання: 0.03 сек.
================================================================================
[2025-10-04 05:45:20] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 05:45:20] 
[RUN] Виконую скрипт: truncate_zp_tables.py
------------------------------------------------------------
[2025-10-04 05:45:20] Traceback (most recent call last):
[2025-10-04 05:45:20]   File "/root/Python/ZP/truncate_zp_tables.py", line 16, in <module>
[2025-10-04 05:45:20]     import mysql.connector
[2025-10-04 05:45:20] ModuleNotFoundError: No module named 'mysql'
[2025-10-04 05:45:20] [TIME] Час виконання скрипта truncate_zp_tables.py: 0.03 сек.
[2025-10-04 05:45:20] [ERROR] Помилка виконання: truncate_zp_tables.py (exit=1). Зупиняємо.
[2025-10-04 05:45:20] [FINISH] Загальний час виконання: 0.04 сек.
================================================================================
[2025-10-04 05:46:05] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 05:46:05] 
[RUN] Виконую скрипт: truncate_zp_tables.py
------------------------------------------------------------
[2025-10-04 05:46:06] [INFO] Підключення до БД olexii_raid@127.0.0.1:3306/petwealth
[2025-10-04 05:46:06] [RUN] TRUNCATE `petwealth`.`zp_collective_bonus` ...
[2025-10-04 05:46:06] [OK] Очищено: `petwealth`.`zp_collective_bonus`
[2025-10-04 05:46:06] [RUN] TRUNCATE `petwealth`.`zp_log_schedule_errors` ...
[2025-10-04 05:46:06] [OK] Очищено: `petwealth`.`zp_log_schedule_errors`
[2025-10-04 05:46:06] [RUN] TRUNCATE `petwealth`.`zp_sales_prem` ...
[2025-10-04 05:46:06] [OK] Очищено: `petwealth`.`zp_sales_prem`
[2025-10-04 05:46:06] [RUN] TRUNCATE `petwealth`.`zp_sales_salary` ...
[2025-10-04 05:46:06] [OK] Очищено: `petwealth`.`zp_sales_salary`
[2025-10-04 05:46:06] [RUN] TRUNCATE `petwealth`.`zp_summary` ...
[2025-10-04 05:46:06] [OK] Очищено: `petwealth`.`zp_summary`
[2025-10-04 05:46:06] [RUN] TRUNCATE `petwealth`.`zp_worktime` ...
[2025-10-04 05:46:06] [OK] Очищено: `petwealth`.`zp_worktime`
[2025-10-04 05:46:06] [RUN] TRUNCATE `petwealth`.`zp_довСпівробітники` ...
[2025-10-04 05:46:06] [OK] Очищено: `petwealth`.`zp_довСпівробітники`
[2025-10-04 05:46:06] [RUN] TRUNCATE `petwealth`.`zp_фктРівніСпівробітників` ...
[2025-10-04 05:46:06] [OK] Очищено: `petwealth`.`zp_фктРівніСпівробітників`
[2025-10-04 05:46:06] [RUN] TRUNCATE `petwealth`.`zp_фктУмовиОплати` ...
[2025-10-04 05:46:06] [OK] Очищено: `petwealth`.`zp_фктУмовиОплати`
[2025-10-04 05:46:06] ----------------------------------------
[2025-10-04 05:46:06] [SUMMARY] Результати очищення:
[2025-10-04 05:46:06]   Очищено: zp_collective_bonus, zp_log_schedule_errors, zp_sales_prem, zp_sales_salary, zp_summary, zp_worktime, zp_довСпівробітники, zp_фктРівніСпівробітників, zp_фктУмовиОплати
[2025-10-04 05:46:06] [TIME] Час виконання скрипта truncate_zp_tables.py: 0.82 сек.
[2025-10-04 05:46:06] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-10-04 05:46:09] [OK] Отримано 6 записів з Єноту
[2025-10-04 05:46:09] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-10-04 05:46:09] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-10-04 05:46:10] [TIME] Час виконання скрипта import_enote_reference.py: 3.58 сек.
[2025-10-04 05:46:10] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-10-04 05:46:34] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-10-04 05:46:35] [TIME] Час виконання скрипта auto_fill_idx.py: 25.13 сек.
[2025-10-04 05:46:35] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-10-04 05:47:15] 
[2025-10-04 05:47:15] [LOG] Початок перевірки графіка — 2025-10-04 05:46:35
[2025-10-04 05:47:15] [LOG] Отримано 31 співробітників з Єнота
[2025-10-04 05:47:15] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-10-04 05:47:15] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-10-04 05:47:15] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-10-04 05:47:15] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-10-04 05:47:15] 
[2025-10-04 05:47:15] [TIME] Час виконання скрипта diagnose_sheets.py: 40.61 сек.
[2025-10-04 05:47:15] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-10-04 05:48:05] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-10-04 05:48:05]   tgt_ws.update(
[2025-10-04 05:48:08] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-10-04 05:48:08] [OK] Таблиця очищена та заголовок додано.
[2025-10-04 05:48:08] [INFO] Формування нових рядків...
[2025-10-04 05:48:08] [OK] Додано 304 актуальних рядків.
[2025-10-04 05:48:08] [INFO] Перевірка на конфлікти...
[2025-10-04 05:48:08] [INFO] Виявлено 0 конфлікт(ів)
[2025-10-04 05:48:08] [INFO] Оновлюємо колонку 'Error'...
[2025-10-04 05:48:08] [INFO] Формуємо перекреслення...
[2025-10-04 05:48:08] 
[2025-10-04 05:48:08] [OK] Конфліктів не знайдено.
[2025-10-04 05:48:08] 
[2025-10-04 05:48:08] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-10-04 05:48:08] [TIME] Час виконання скрипта fill_flat_schedule.py: 52.61 сек.
[2025-10-04 05:48:08] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-10-04 05:48:10] [INFO] Нічого не видалено.
[2025-10-04 05:48:10] [OK] Додано: 304, Оновлено: 0, Пропущено: 0
[2025-10-04 05:48:11] [TIME] Час виконання скрипта worktime.py: 2.81 сек.
[2025-10-04 05:48:11] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-10-04 05:48:27] [START] Скрипт запущено: 2025-10-04 05:48:11
[2025-10-04 05:48:27] [OK] Отримано 29 рядків із Google Sheets.
[2025-10-04 05:48:27] [OK] Колонка ID оновлена у Google Sheets.
[2025-10-04 05:48:27] [OK] Діапазони захищено у Google Sheets.
[2025-10-04 05:48:27] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-10-04 05:48:27] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-10-04 05:48:27] [OK] Дані оновлені у Google Sheets.
[2025-10-04 05:48:27] 
[2025-10-04 05:48:27] [ERROR] Виявлено дублікати за ключем групи правил (скрипт зупинено).
[2025-10-04 05:48:27] [DUP] (ДатаПочатку='2025-09-01', Посада=None, Відділення=None, Рівень=None, ТипЗміни=None, Прізвище=None, АнЗП=None, АнЗП_Колективний=None) | К-сть: 13 | Рядки ID: 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29
[2025-10-04 05:48:27] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 16.29 сек.
[2025-10-04 05:48:27] [ERROR] Помилка виконання: sync_fkt_UmoviOplaty.py (exit=2). Зупиняємо.
[2025-10-04 05:48:27] [FINISH] Загальний час виконання: 141.86 сек.
================================================================================
[2025-10-04 05:50:46] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 05:50:46] 
[RUN] Виконую скрипт: truncate_zp_tables.py
------------------------------------------------------------
[2025-10-04 05:50:46] Traceback (most recent call last):
[2025-10-04 05:50:46]   File "/root/Python/ZP/truncate_zp_tables.py", line 16, in <module>
[2025-10-04 05:50:46]     import mysql.connector
[2025-10-04 05:50:46] ModuleNotFoundError: No module named 'mysql'
[2025-10-04 05:50:46] [TIME] Час виконання скрипта truncate_zp_tables.py: 0.03 сек.
[2025-10-04 05:50:46] [ERROR] Помилка виконання: truncate_zp_tables.py (exit=1). Зупиняємо.
[2025-10-04 05:50:46] [FINISH] Загальний час виконання: 0.03 сек.
================================================================================
[2025-10-04 05:51:20] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 05:51:20] 
[RUN] Виконую скрипт: truncate_zp_tables.py
------------------------------------------------------------
[2025-10-04 05:51:20] [INFO] Підключення до БД olexii_raid@127.0.0.1:3306/petwealth
[2025-10-04 05:51:20] [RUN] TRUNCATE `petwealth`.`zp_collective_bonus` ...
[2025-10-04 05:51:20] [OK] Очищено: `petwealth`.`zp_collective_bonus`
[2025-10-04 05:51:20] [RUN] TRUNCATE `petwealth`.`zp_log_schedule_errors` ...
[2025-10-04 05:51:20] [OK] Очищено: `petwealth`.`zp_log_schedule_errors`
[2025-10-04 05:51:20] [RUN] TRUNCATE `petwealth`.`zp_sales_prem` ...
[2025-10-04 05:51:20] [OK] Очищено: `petwealth`.`zp_sales_prem`
[2025-10-04 05:51:20] [RUN] TRUNCATE `petwealth`.`zp_sales_salary` ...
[2025-10-04 05:51:20] [OK] Очищено: `petwealth`.`zp_sales_salary`
[2025-10-04 05:51:20] [RUN] TRUNCATE `petwealth`.`zp_summary` ...
[2025-10-04 05:51:20] [OK] Очищено: `petwealth`.`zp_summary`
[2025-10-04 05:51:20] [RUN] TRUNCATE `petwealth`.`zp_worktime` ...
[2025-10-04 05:51:20] [OK] Очищено: `petwealth`.`zp_worktime`
[2025-10-04 05:51:20] [RUN] TRUNCATE `petwealth`.`zp_довСпівробітники` ...
[2025-10-04 05:51:20] [OK] Очищено: `petwealth`.`zp_довСпівробітники`
[2025-10-04 05:51:20] [RUN] TRUNCATE `petwealth`.`zp_фктРівніСпівробітників` ...
[2025-10-04 05:51:20] [OK] Очищено: `petwealth`.`zp_фктРівніСпівробітників`
[2025-10-04 05:51:20] [RUN] TRUNCATE `petwealth`.`zp_фктУмовиОплати` ...
[2025-10-04 05:51:20] [OK] Очищено: `petwealth`.`zp_фктУмовиОплати`
[2025-10-04 05:51:20] ----------------------------------------
[2025-10-04 05:51:20] [SUMMARY] Результати очищення:
[2025-10-04 05:51:20]   Очищено: zp_collective_bonus, zp_log_schedule_errors, zp_sales_prem, zp_sales_salary, zp_summary, zp_worktime, zp_довСпівробітники, zp_фктРівніСпівробітників, zp_фктУмовиОплати
[2025-10-04 05:51:20] [TIME] Час виконання скрипта truncate_zp_tables.py: 0.77 сек.
[2025-10-04 05:51:20] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-10-04 05:51:24] [OK] Отримано 6 записів з Єноту
[2025-10-04 05:51:24] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-10-04 05:51:24] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-10-04 05:51:24] [TIME] Час виконання скрипта import_enote_reference.py: 3.72 сек.
[2025-10-04 05:51:24] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-10-04 05:51:47] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-10-04 05:51:47] [TIME] Час виконання скрипта auto_fill_idx.py: 22.58 сек.
[2025-10-04 05:51:47] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-10-04 05:52:26] 
[2025-10-04 05:52:26] [LOG] Початок перевірки графіка — 2025-10-04 05:51:47
[2025-10-04 05:52:26] [LOG] Отримано 31 співробітників з Єнота
[2025-10-04 05:52:26] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-10-04 05:52:26] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-10-04 05:52:26] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-10-04 05:52:26] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-10-04 05:52:26] 
[2025-10-04 05:52:26] [TIME] Час виконання скрипта diagnose_sheets.py: 39.31 сек.
[2025-10-04 05:52:26] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-10-04 05:53:16] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-10-04 05:53:16]   tgt_ws.update(
[2025-10-04 05:53:18] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-10-04 05:53:18] [OK] Таблиця очищена та заголовок додано.
[2025-10-04 05:53:18] [INFO] Формування нових рядків...
[2025-10-04 05:53:18] [OK] Додано 304 актуальних рядків.
[2025-10-04 05:53:18] [INFO] Перевірка на конфлікти...
[2025-10-04 05:53:18] [INFO] Виявлено 0 конфлікт(ів)
[2025-10-04 05:53:18] [INFO] Оновлюємо колонку 'Error'...
[2025-10-04 05:53:18] [INFO] Формуємо перекреслення...
[2025-10-04 05:53:18] 
[2025-10-04 05:53:18] [OK] Конфліктів не знайдено.
[2025-10-04 05:53:18] 
[2025-10-04 05:53:18] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-10-04 05:53:18] [TIME] Час виконання скрипта fill_flat_schedule.py: 51.98 сек.
[2025-10-04 05:53:18] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-10-04 05:53:21] [INFO] Нічого не видалено.
[2025-10-04 05:53:21] [OK] Додано: 304, Оновлено: 0, Пропущено: 0
[2025-10-04 05:53:21] [TIME] Час виконання скрипта worktime.py: 2.93 сек.
[2025-10-04 05:53:21] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-10-04 05:53:37] [START] Скрипт запущено: 2025-10-04 05:53:22
[2025-10-04 05:53:37] [OK] Отримано 16 рядків із Google Sheets.
[2025-10-04 05:53:37] [OK] Колонка ID оновлена у Google Sheets.
[2025-10-04 05:53:37] [OK] Діапазони захищено у Google Sheets.
[2025-10-04 05:53:37] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-10-04 05:53:37] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-10-04 05:53:37] [OK] Дані оновлені у Google Sheets.
[2025-10-04 05:53:37] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 16 рядків.
[2025-10-04 05:53:37] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 16.29 сек.
[2025-10-04 05:53:37] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-10-04 05:53:40] [2025-10-04 05:53:38] [SYNC] Початок синхронізації рівнів співробітників...
[2025-10-04 05:53:40] [2025-10-04 05:53:40] [OK] Google Sheets оновлено!
[2025-10-04 05:53:40] [2025-10-04 05:53:40] [OK] Завантажено: 40 додано, 0 оновлено.
[2025-10-04 05:53:40] [2025-10-04 05:53:40] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-10-04 05:53:40] [2025-10-04 05:53:40] [OK] Обробка завершена!
[2025-10-04 05:53:41] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.3 сек.
[2025-10-04 05:53:41] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-10-04 05:54:24] [INFO] Виконуємо SQL-запит...
[2025-10-04 05:54:24] [OK] Отримано 48392 рядків
[2025-10-04 05:54:24] [OK] Дублікатів за ключовими полями немає.
[2025-10-04 05:54:24] [DELETE] Очищення старих записів...
[2025-10-04 05:54:24] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-10-04 05:54:24] [OK] Дані успішно завантажені!
[2025-10-04 05:54:24] [TIME] Час виконання скрипта zp_sales_salary_new.py: 43.5 сек.
[2025-10-04 05:54:24] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-10-04 05:54:25] [SYNC] Розпочато обробку змін...
[2025-10-04 05:54:25] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-10-04 05:54:25] [OK] Отримано 304 змін для обробки.
[2025-10-04 05:54:25] [FINISH] Обробка завершена: 0 записів премій.
[2025-10-04 05:54:25] [TIME] Час виконання скрипта zp_collective_bonus.py: 0.6 сек.
[2025-10-04 05:54:25] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-10-04 05:54:26] 
[2025-10-04 05:54:26] ===============================
[2025-10-04 05:54:26] Період від 2025-05-01
[2025-10-04 05:54:26] По Стоимость: 241,526.15
[2025-10-04 05:54:26] По СтоимостьБезСкидок: 242,195.91
[2025-10-04 05:54:26] По ВаловийПрибуток: 239,325.31
[2025-10-04 05:54:26] ===============================
[2025-10-04 05:54:26] 
[2025-10-04 05:54:26] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-10-04 05:54:26] [TIME] Час виконання скрипта summary.py: 1.73 сек.
[2025-10-04 05:54:26] [FINISH] Загальний час виконання: 186.71 сек.
================================================================================
[2025-10-04 06:08:37] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 06:08:37] 
[RUN] Виконую скрипт: truncate_zp_tables.py
------------------------------------------------------------
[2025-10-04 06:08:38] [INFO] Підключення до БД olexii_raid@127.0.0.1:3306/petwealth
[2025-10-04 06:08:38] [RUN] TRUNCATE `petwealth`.`zp_collective_bonus` ...
[2025-10-04 06:08:38] [OK] Очищено: `petwealth`.`zp_collective_bonus`
[2025-10-04 06:08:38] [RUN] TRUNCATE `petwealth`.`zp_log_schedule_errors` ...
[2025-10-04 06:08:38] [OK] Очищено: `petwealth`.`zp_log_schedule_errors`
[2025-10-04 06:08:38] [RUN] TRUNCATE `petwealth`.`zp_sales_prem` ...
[2025-10-04 06:08:38] [OK] Очищено: `petwealth`.`zp_sales_prem`
[2025-10-04 06:08:38] [RUN] TRUNCATE `petwealth`.`zp_sales_salary` ...
[2025-10-04 06:08:38] [OK] Очищено: `petwealth`.`zp_sales_salary`
[2025-10-04 06:08:38] [RUN] TRUNCATE `petwealth`.`zp_summary` ...
[2025-10-04 06:08:38] [OK] Очищено: `petwealth`.`zp_summary`
[2025-10-04 06:08:38] [RUN] TRUNCATE `petwealth`.`zp_worktime` ...
[2025-10-04 06:08:38] [OK] Очищено: `petwealth`.`zp_worktime`
[2025-10-04 06:08:38] [RUN] TRUNCATE `petwealth`.`zp_довСпівробітники` ...
[2025-10-04 06:08:38] [OK] Очищено: `petwealth`.`zp_довСпівробітники`
[2025-10-04 06:08:38] [RUN] TRUNCATE `petwealth`.`zp_фктРівніСпівробітників` ...
[2025-10-04 06:08:38] [OK] Очищено: `petwealth`.`zp_фктРівніСпівробітників`
[2025-10-04 06:08:38] [RUN] TRUNCATE `petwealth`.`zp_фктУмовиОплати` ...
[2025-10-04 06:08:38] [OK] Очищено: `petwealth`.`zp_фктУмовиОплати`
[2025-10-04 06:08:38] ----------------------------------------
[2025-10-04 06:08:38] [SUMMARY] Результати очищення:
[2025-10-04 06:08:38]   Очищено: zp_collective_bonus, zp_log_schedule_errors, zp_sales_prem, zp_sales_salary, zp_summary, zp_worktime, zp_довСпівробітники, zp_фктРівніСпівробітників, zp_фктУмовиОплати
[2025-10-04 06:08:38] [TIME] Час виконання скрипта truncate_zp_tables.py: 0.77 сек.
[2025-10-04 06:08:38] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-10-04 06:08:42] [OK] Отримано 6 записів з Єноту
[2025-10-04 06:08:42] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-10-04 06:08:42] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-10-04 06:08:42] [TIME] Час виконання скрипта import_enote_reference.py: 3.73 сек.
[2025-10-04 06:08:42] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-10-04 06:09:06] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-10-04 06:09:06] [TIME] Час виконання скрипта auto_fill_idx.py: 24.32 сек.
[2025-10-04 06:09:06] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-10-04 06:09:47] 
[2025-10-04 06:09:47] [LOG] Початок перевірки графіка — 2025-10-04 06:09:07
[2025-10-04 06:09:47] [LOG] Отримано 31 співробітників з Єнота
[2025-10-04 06:09:47] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-10-04 06:09:47] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-10-04 06:09:47] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-10-04 06:09:47] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-10-04 06:09:47] 
[2025-10-04 06:09:47] [TIME] Час виконання скрипта diagnose_sheets.py: 41.25 сек.
[2025-10-04 06:09:47] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-10-04 06:10:39] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-10-04 06:10:39]   tgt_ws.update(
[2025-10-04 06:10:40] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-10-04 06:10:40] [OK] Таблиця очищена та заголовок додано.
[2025-10-04 06:10:40] [INFO] Формування нових рядків...
[2025-10-04 06:10:40] [OK] Додано 304 актуальних рядків.
[2025-10-04 06:10:40] [INFO] Перевірка на конфлікти...
[2025-10-04 06:10:40] [INFO] Виявлено 0 конфлікт(ів)
[2025-10-04 06:10:40] [INFO] Оновлюємо колонку 'Error'...
[2025-10-04 06:10:40] [INFO] Формуємо перекреслення...
[2025-10-04 06:10:40] 
[2025-10-04 06:10:40] [OK] Конфліктів не знайдено.
[2025-10-04 06:10:40] 
[2025-10-04 06:10:40] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-10-04 06:10:40] [TIME] Час виконання скрипта fill_flat_schedule.py: 52.94 сек.
[2025-10-04 06:10:40] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-10-04 06:10:43] [INFO] Нічого не видалено.
[2025-10-04 06:10:43] [OK] Додано: 304, Оновлено: 0, Пропущено: 0
[2025-10-04 06:10:43] [TIME] Час виконання скрипта worktime.py: 2.97 сек.
[2025-10-04 06:10:43] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-10-04 06:11:00] [START] Скрипт запущено: 2025-10-04 06:10:44
[2025-10-04 06:11:00] [OK] Отримано 16 рядків із Google Sheets.
[2025-10-04 06:11:00] [OK] Колонка ID оновлена у Google Sheets.
[2025-10-04 06:11:00] [OK] Діапазони захищено у Google Sheets.
[2025-10-04 06:11:00] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-10-04 06:11:00] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-10-04 06:11:00] [OK] Дані оновлені у Google Sheets.
[2025-10-04 06:11:00] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 16 рядків.
[2025-10-04 06:11:00] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 16.99 сек.
[2025-10-04 06:11:00] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-10-04 06:11:04] [2025-10-04 06:11:01] [SYNC] Початок синхронізації рівнів співробітників...
[2025-10-04 06:11:04] [2025-10-04 06:11:04] [OK] Google Sheets оновлено!
[2025-10-04 06:11:04] [2025-10-04 06:11:04] [OK] Завантажено: 40 додано, 0 оновлено.
[2025-10-04 06:11:04] [2025-10-04 06:11:04] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-10-04 06:11:04] [2025-10-04 06:11:04] [OK] Обробка завершена!
[2025-10-04 06:11:04] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.91 сек.
[2025-10-04 06:11:04] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-10-04 06:11:43] [INFO] Виконуємо SQL-запит...
[2025-10-04 06:11:43] [OK] Отримано 48392 рядків
[2025-10-04 06:11:43] [OK] Дублікатів за ключовими полями немає.
[2025-10-04 06:11:43] [DELETE] Очищення старих записів...
[2025-10-04 06:11:43] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-10-04 06:11:43] [OK] Дані успішно завантажені!
[2025-10-04 06:11:44] [TIME] Час виконання скрипта zp_sales_salary_new.py: 39.42 сек.
[2025-10-04 06:11:44] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-10-04 06:11:44] [SYNC] Розпочато обробку змін...
[2025-10-04 06:11:44] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-10-04 06:11:44] [OK] Отримано 304 змін для обробки.
[2025-10-04 06:11:44] [FINISH] Обробка завершена: 0 записів премій.
[2025-10-04 06:11:44] [TIME] Час виконання скрипта zp_collective_bonus.py: 0.66 сек.
[2025-10-04 06:11:44] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-10-04 06:11:46] 
[2025-10-04 06:11:46] ===============================
[2025-10-04 06:11:46] Період від 2025-05-01
[2025-10-04 06:11:46] По Стоимость: 241,526.15
[2025-10-04 06:11:46] По СтоимостьБезСкидок: 242,195.91
[2025-10-04 06:11:46] По ВаловийПрибуток: 239,325.31
[2025-10-04 06:11:46] ===============================
[2025-10-04 06:11:46] 
[2025-10-04 06:11:46] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-10-04 06:11:46] [TIME] Час виконання скрипта summary.py: 1.5 сек.
[2025-10-04 06:11:46] [FINISH] Загальний час виконання: 188.48 сек.
================================================================================
[2025-10-04 06:23:45] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 06:23:45] 
[RUN] Виконую скрипт: truncate_zp_tables.py
------------------------------------------------------------
[2025-10-04 06:23:46] [INFO] Підключення до БД olexii_raid@127.0.0.1:3306/petwealth
[2025-10-04 06:23:46] [RUN] TRUNCATE `petwealth`.`zp_collective_bonus` ...
[2025-10-04 06:23:46] [OK] Очищено: `petwealth`.`zp_collective_bonus`
[2025-10-04 06:23:46] [RUN] TRUNCATE `petwealth`.`zp_log_schedule_errors` ...
[2025-10-04 06:23:46] [OK] Очищено: `petwealth`.`zp_log_schedule_errors`
[2025-10-04 06:23:46] [RUN] TRUNCATE `petwealth`.`zp_sales_prem` ...
[2025-10-04 06:23:46] [OK] Очищено: `petwealth`.`zp_sales_prem`
[2025-10-04 06:23:46] [RUN] TRUNCATE `petwealth`.`zp_sales_salary` ...
[2025-10-04 06:23:46] [OK] Очищено: `petwealth`.`zp_sales_salary`
[2025-10-04 06:23:46] [RUN] TRUNCATE `petwealth`.`zp_summary` ...
[2025-10-04 06:23:46] [OK] Очищено: `petwealth`.`zp_summary`
[2025-10-04 06:23:46] [RUN] TRUNCATE `petwealth`.`zp_worktime` ...
[2025-10-04 06:23:46] [OK] Очищено: `petwealth`.`zp_worktime`
[2025-10-04 06:23:46] [RUN] TRUNCATE `petwealth`.`zp_довСпівробітники` ...
[2025-10-04 06:23:46] [OK] Очищено: `petwealth`.`zp_довСпівробітники`
[2025-10-04 06:23:46] [RUN] TRUNCATE `petwealth`.`zp_фктРівніСпівробітників` ...
[2025-10-04 06:23:46] [OK] Очищено: `petwealth`.`zp_фктРівніСпівробітників`
[2025-10-04 06:23:46] [RUN] TRUNCATE `petwealth`.`zp_фктУмовиОплати` ...
[2025-10-04 06:23:46] [OK] Очищено: `petwealth`.`zp_фктУмовиОплати`
[2025-10-04 06:23:46] ----------------------------------------
[2025-10-04 06:23:46] [SUMMARY] Результати очищення:
[2025-10-04 06:23:46]   Очищено: zp_collective_bonus, zp_log_schedule_errors, zp_sales_prem, zp_sales_salary, zp_summary, zp_worktime, zp_довСпівробітники, zp_фктРівніСпівробітників, zp_фктУмовиОплати
[2025-10-04 06:23:46] [TIME] Час виконання скрипта truncate_zp_tables.py: 0.71 сек.
[2025-10-04 06:23:46] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-10-04 06:23:49] [OK] Отримано 6 записів з Єноту
[2025-10-04 06:23:49] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-10-04 06:23:49] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-10-04 06:23:49] [TIME] Час виконання скрипта import_enote_reference.py: 3.01 сек.
[2025-10-04 06:23:49] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-10-04 06:24:14] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-10-04 06:24:14] [TIME] Час виконання скрипта auto_fill_idx.py: 24.91 сек.
[2025-10-04 06:24:14] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-10-04 06:24:54] 
[2025-10-04 06:24:54] [LOG] Початок перевірки графіка — 2025-10-04 06:24:14
[2025-10-04 06:24:54] [LOG] Отримано 31 співробітників з Єнота
[2025-10-04 06:24:54] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-10-04 06:24:54] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-10-04 06:24:54] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-10-04 06:24:54] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-10-04 06:24:54] 
[2025-10-04 06:24:54] [TIME] Час виконання скрипта diagnose_sheets.py: 40.42 сек.
[2025-10-04 06:24:54] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-10-04 06:25:47] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-10-04 06:25:47]   tgt_ws.update(
[2025-10-04 06:25:49] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-10-04 06:25:49] [OK] Таблиця очищена та заголовок додано.
[2025-10-04 06:25:49] [INFO] Формування нових рядків...
[2025-10-04 06:25:49] [OK] Додано 304 актуальних рядків.
[2025-10-04 06:25:49] [INFO] Перевірка на конфлікти...
[2025-10-04 06:25:49] [INFO] Виявлено 0 конфлікт(ів)
[2025-10-04 06:25:49] [INFO] Оновлюємо колонку 'Error'...
[2025-10-04 06:25:49] [INFO] Формуємо перекреслення...
[2025-10-04 06:25:49] 
[2025-10-04 06:25:49] [OK] Конфліктів не знайдено.
[2025-10-04 06:25:49] 
[2025-10-04 06:25:49] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-10-04 06:25:49] [TIME] Час виконання скрипта fill_flat_schedule.py: 55.2 сек.
[2025-10-04 06:25:49] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-10-04 06:25:52] [INFO] Нічого не видалено.
[2025-10-04 06:25:52] [OK] Додано: 304, Оновлено: 0, Пропущено: 0
[2025-10-04 06:25:52] [TIME] Час виконання скрипта worktime.py: 2.37 сек.
[2025-10-04 06:25:52] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-10-04 06:26:07] [START] Скрипт запущено: 2025-10-04 06:25:53
[2025-10-04 06:26:07] [OK] Отримано 16 рядків із Google Sheets.
[2025-10-04 06:26:07] [OK] Колонка ID оновлена у Google Sheets.
[2025-10-04 06:26:07] [OK] Діапазони захищено у Google Sheets.
[2025-10-04 06:26:07] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-10-04 06:26:07] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-10-04 06:26:07] [OK] Дані оновлені у Google Sheets.
[2025-10-04 06:26:07] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 16 рядків.
[2025-10-04 06:26:08] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 15.91 сек.
[2025-10-04 06:26:08] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-10-04 06:26:11] [2025-10-04 06:26:09] [SYNC] Початок синхронізації рівнів співробітників...
[2025-10-04 06:26:11] [2025-10-04 06:26:10] [OK] Google Sheets оновлено!
[2025-10-04 06:26:11] [2025-10-04 06:26:11] [OK] Завантажено: 40 додано, 0 оновлено.
[2025-10-04 06:26:11] [2025-10-04 06:26:11] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-10-04 06:26:11] [2025-10-04 06:26:11] [OK] Обробка завершена!
[2025-10-04 06:26:11] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.36 сек.
[2025-10-04 06:26:11] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-10-04 06:26:51] [INFO] Виконуємо SQL-запит...
[2025-10-04 06:26:51] [OK] Отримано 48392 рядків
[2025-10-04 06:26:51] [OK] Дублікатів за ключовими полями немає.
[2025-10-04 06:26:51] [DELETE] Очищення старих записів...
[2025-10-04 06:26:51] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-10-04 06:26:51] [OK] Дані успішно завантажені!
[2025-10-04 06:26:52] [TIME] Час виконання скрипта zp_sales_salary_new.py: 40.48 сек.
[2025-10-04 06:26:52] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-10-04 06:26:52] [SYNC] Розпочато обробку змін...
[2025-10-04 06:26:52] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-10-04 06:26:52] [OK] Отримано 304 змін для обробки.
[2025-10-04 06:26:52] [FINISH] Обробка завершена: 0 записів премій.
[2025-10-04 06:26:52] [TIME] Час виконання скрипта zp_collective_bonus.py: 0.71 сек.
[2025-10-04 06:26:52] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-10-04 06:26:54] 
[2025-10-04 06:26:54] ===============================
[2025-10-04 06:26:54] Період від 2025-05-01
[2025-10-04 06:26:54] По Стоимость: 241,526.15
[2025-10-04 06:26:54] По СтоимостьБезСкидок: 242,195.91
[2025-10-04 06:26:54] По ВаловийПрибуток: 239,325.31
[2025-10-04 06:26:54] ===============================
[2025-10-04 06:26:54] 
[2025-10-04 06:26:54] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-10-04 06:26:54] [TIME] Час виконання скрипта summary.py: 1.79 сек.
[2025-10-04 06:26:54] [FINISH] Загальний час виконання: 188.88 сек.
================================================================================
[2025-10-04 06:53:46] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 06:53:46] 
[RUN] Виконую скрипт: truncate_zp_tables.py
------------------------------------------------------------
[2025-10-04 06:53:47] [INFO] Підключення до БД olexii_raid@127.0.0.1:3306/petwealth
[2025-10-04 06:53:47] [RUN] TRUNCATE `petwealth`.`zp_collective_bonus` ...
[2025-10-04 06:53:47] [OK] Очищено: `petwealth`.`zp_collective_bonus`
[2025-10-04 06:53:47] [RUN] TRUNCATE `petwealth`.`zp_log_schedule_errors` ...
[2025-10-04 06:53:47] [OK] Очищено: `petwealth`.`zp_log_schedule_errors`
[2025-10-04 06:53:47] [RUN] TRUNCATE `petwealth`.`zp_sales_prem` ...
[2025-10-04 06:53:47] [OK] Очищено: `petwealth`.`zp_sales_prem`
[2025-10-04 06:53:47] [RUN] TRUNCATE `petwealth`.`zp_sales_salary` ...
[2025-10-04 06:53:47] [OK] Очищено: `petwealth`.`zp_sales_salary`
[2025-10-04 06:53:47] [RUN] TRUNCATE `petwealth`.`zp_summary` ...
[2025-10-04 06:53:47] [OK] Очищено: `petwealth`.`zp_summary`
[2025-10-04 06:53:47] [RUN] TRUNCATE `petwealth`.`zp_worktime` ...
[2025-10-04 06:53:47] [OK] Очищено: `petwealth`.`zp_worktime`
[2025-10-04 06:53:47] [RUN] TRUNCATE `petwealth`.`zp_довСпівробітники` ...
[2025-10-04 06:53:47] [OK] Очищено: `petwealth`.`zp_довСпівробітники`
[2025-10-04 06:53:47] [RUN] TRUNCATE `petwealth`.`zp_фктРівніСпівробітників` ...
[2025-10-04 06:53:47] [OK] Очищено: `petwealth`.`zp_фктРівніСпівробітників`
[2025-10-04 06:53:47] [RUN] TRUNCATE `petwealth`.`zp_фктУмовиОплати` ...
[2025-10-04 06:53:47] [OK] Очищено: `petwealth`.`zp_фктУмовиОплати`
[2025-10-04 06:53:47] ----------------------------------------
[2025-10-04 06:53:47] [SUMMARY] Результати очищення:
[2025-10-04 06:53:47]   Очищено: zp_collective_bonus, zp_log_schedule_errors, zp_sales_prem, zp_sales_salary, zp_summary, zp_worktime, zp_довСпівробітники, zp_фктРівніСпівробітників, zp_фктУмовиОплати
[2025-10-04 06:53:47] [TIME] Час виконання скрипта truncate_zp_tables.py: 0.7 сек.
[2025-10-04 06:53:47] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-10-04 06:53:50] [OK] Отримано 6 записів з Єноту
[2025-10-04 06:53:50] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-10-04 06:53:50] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-10-04 06:53:50] [TIME] Час виконання скрипта import_enote_reference.py: 2.71 сек.
[2025-10-04 06:53:50] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-10-04 06:54:16] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-10-04 06:54:16] [TIME] Час виконання скрипта auto_fill_idx.py: 26.67 сек.
[2025-10-04 06:54:16] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-10-04 06:55:00] 
[2025-10-04 06:55:00] [LOG] Початок перевірки графіка — 2025-10-04 06:54:17
[2025-10-04 06:55:00] [LOG] Отримано 31 співробітників з Єнота
[2025-10-04 06:55:00] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-10-04 06:55:00] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-10-04 06:55:00] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-10-04 06:55:00] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-10-04 06:55:00] 
[2025-10-04 06:55:00] [TIME] Час виконання скрипта diagnose_sheets.py: 43.6 сек.
[2025-10-04 06:55:00] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-10-04 06:55:53] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-10-04 06:55:53]   tgt_ws.update(
[2025-10-04 06:55:55] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-10-04 06:55:55] [OK] Таблиця очищена та заголовок додано.
[2025-10-04 06:55:55] [INFO] Формування нових рядків...
[2025-10-04 06:55:55] [OK] Додано 304 актуальних рядків.
[2025-10-04 06:55:55] [INFO] Перевірка на конфлікти...
[2025-10-04 06:55:55] [INFO] Виявлено 0 конфлікт(ів)
[2025-10-04 06:55:55] [INFO] Оновлюємо колонку 'Error'...
[2025-10-04 06:55:55] [INFO] Формуємо перекреслення...
[2025-10-04 06:55:55] 
[2025-10-04 06:55:55] [OK] Конфліктів не знайдено.
[2025-10-04 06:55:55] 
[2025-10-04 06:55:55] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-10-04 06:55:55] [TIME] Час виконання скрипта fill_flat_schedule.py: 55.43 сек.
[2025-10-04 06:55:55] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-10-04 06:55:57] [INFO] Нічого не видалено.
[2025-10-04 06:55:57] [OK] Додано: 304, Оновлено: 0, Пропущено: 0
[2025-10-04 06:55:58] [TIME] Час виконання скрипта worktime.py: 2.07 сек.
[2025-10-04 06:55:58] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-10-04 06:56:14] [START] Скрипт запущено: 2025-10-04 06:55:58
[2025-10-04 06:56:14] [OK] Отримано 16 рядків із Google Sheets.
[2025-10-04 06:56:14] [OK] Колонка ID оновлена у Google Sheets.
[2025-10-04 06:56:14] [OK] Діапазони захищено у Google Sheets.
[2025-10-04 06:56:14] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-10-04 06:56:14] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-10-04 06:56:14] [OK] Дані оновлені у Google Sheets.
[2025-10-04 06:56:14] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 16 рядків.
[2025-10-04 06:56:14] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 16.86 сек.
[2025-10-04 06:56:14] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-10-04 06:56:18] [2025-10-04 06:56:15] [SYNC] Початок синхронізації рівнів співробітників...
[2025-10-04 06:56:18] [2025-10-04 06:56:18] [OK] Google Sheets оновлено!
[2025-10-04 06:56:18] [2025-10-04 06:56:18] [OK] Завантажено: 40 додано, 0 оновлено.
[2025-10-04 06:56:18] [2025-10-04 06:56:18] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-10-04 06:56:18] [2025-10-04 06:56:18] [OK] Обробка завершена!
[2025-10-04 06:56:18] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.98 сек.
[2025-10-04 06:56:18] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-10-04 06:57:00] [INFO] Виконуємо SQL-запит...
[2025-10-04 06:57:00] [OK] Отримано 48392 рядків
[2025-10-04 06:57:00] [OK] Дублікатів за ключовими полями немає.
[2025-10-04 06:57:00] [DELETE] Очищення старих записів...
[2025-10-04 06:57:00] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-10-04 06:57:00] [OK] Дані успішно завантажені!
[2025-10-04 06:57:00] [TIME] Час виконання скрипта zp_sales_salary_new.py: 41.44 сек.
[2025-10-04 06:57:00] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-10-04 06:57:05] [SYNC] Розпочато обробку змін...
[2025-10-04 06:57:05] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-10-04 06:57:05] [OK] Отримано 304 змін для обробки.
[2025-10-04 06:57:05] [FINISH] Обробка завершена: 66 записів премій.
[2025-10-04 06:57:05] [TIME] Час виконання скрипта zp_collective_bonus.py: 4.94 сек.
[2025-10-04 06:57:05] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-10-04 06:57:06] 
[2025-10-04 06:57:06] ===============================
[2025-10-04 06:57:06] Період від 2025-05-01
[2025-10-04 06:57:06] По Стоимость: 345,713.00
[2025-10-04 06:57:06] По СтоимостьБезСкидок: 347,325.00
[2025-10-04 06:57:06] По ВаловийПрибуток: 334,309.01
[2025-10-04 06:57:06] ===============================
[2025-10-04 06:57:06] 
[2025-10-04 06:57:06] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-10-04 06:57:07] [TIME] Час виконання скрипта summary.py: 1.96 сек.
[2025-10-04 06:57:07] [FINISH] Загальний час виконання: 200.35 сек.
================================================================================
[2025-10-04 06:59:11] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 06:59:11] 
[RUN] Виконую скрипт: truncate_zp_tables.py
------------------------------------------------------------
[2025-10-04 06:59:11] [INFO] Підключення до БД olexii_raid@127.0.0.1:3306/petwealth
[2025-10-04 06:59:11] [RUN] TRUNCATE `petwealth`.`zp_collective_bonus` ...
[2025-10-04 06:59:11] [OK] Очищено: `petwealth`.`zp_collective_bonus`
[2025-10-04 06:59:11] [RUN] TRUNCATE `petwealth`.`zp_log_schedule_errors` ...
[2025-10-04 06:59:11] [OK] Очищено: `petwealth`.`zp_log_schedule_errors`
[2025-10-04 06:59:11] [RUN] TRUNCATE `petwealth`.`zp_sales_prem` ...
[2025-10-04 06:59:11] [OK] Очищено: `petwealth`.`zp_sales_prem`
[2025-10-04 06:59:11] [RUN] TRUNCATE `petwealth`.`zp_sales_salary` ...
[2025-10-04 06:59:11] [OK] Очищено: `petwealth`.`zp_sales_salary`
[2025-10-04 06:59:11] [RUN] TRUNCATE `petwealth`.`zp_summary` ...
[2025-10-04 06:59:11] [OK] Очищено: `petwealth`.`zp_summary`
[2025-10-04 06:59:11] [RUN] TRUNCATE `petwealth`.`zp_worktime` ...
[2025-10-04 06:59:11] [OK] Очищено: `petwealth`.`zp_worktime`
[2025-10-04 06:59:11] [RUN] TRUNCATE `petwealth`.`zp_довСпівробітники` ...
[2025-10-04 06:59:11] [OK] Очищено: `petwealth`.`zp_довСпівробітники`
[2025-10-04 06:59:11] [RUN] TRUNCATE `petwealth`.`zp_фктРівніСпівробітників` ...
[2025-10-04 06:59:11] [OK] Очищено: `petwealth`.`zp_фктРівніСпівробітників`
[2025-10-04 06:59:11] [RUN] TRUNCATE `petwealth`.`zp_фктУмовиОплати` ...
[2025-10-04 06:59:11] [OK] Очищено: `petwealth`.`zp_фктУмовиОплати`
[2025-10-04 06:59:11] ----------------------------------------
[2025-10-04 06:59:11] [SUMMARY] Результати очищення:
[2025-10-04 06:59:11]   Очищено: zp_collective_bonus, zp_log_schedule_errors, zp_sales_prem, zp_sales_salary, zp_summary, zp_worktime, zp_довСпівробітники, zp_фктРівніСпівробітників, zp_фктУмовиОплати
[2025-10-04 06:59:11] [TIME] Час виконання скрипта truncate_zp_tables.py: 0.77 сек.
[2025-10-04 06:59:11] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-10-04 06:59:14] [OK] Отримано 6 записів з Єноту
[2025-10-04 06:59:14] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-10-04 06:59:14] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-10-04 06:59:14] [TIME] Час виконання скрипта import_enote_reference.py: 2.52 сек.
[2025-10-04 06:59:14] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-10-04 06:59:39] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-10-04 06:59:39] [TIME] Час виконання скрипта auto_fill_idx.py: 25.19 сек.
[2025-10-04 06:59:39] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-10-04 07:00:21] 
[2025-10-04 07:00:21] [LOG] Початок перевірки графіка — 2025-10-04 06:59:40
[2025-10-04 07:00:21] [LOG] Отримано 31 співробітників з Єнота
[2025-10-04 07:00:21] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-10-04 07:00:21] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-10-04 07:00:21] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-10-04 07:00:21] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-10-04 07:00:21] 
[2025-10-04 07:00:21] [TIME] Час виконання скрипта diagnose_sheets.py: 42.1 сек.
[2025-10-04 07:00:21] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-10-04 07:01:16] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-10-04 07:01:16]   tgt_ws.update(
[2025-10-04 07:01:18] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-10-04 07:01:18] [OK] Таблиця очищена та заголовок додано.
[2025-10-04 07:01:18] [INFO] Формування нових рядків...
[2025-10-04 07:01:18] [OK] Додано 304 актуальних рядків.
[2025-10-04 07:01:18] [INFO] Перевірка на конфлікти...
[2025-10-04 07:01:18] [INFO] Виявлено 0 конфлікт(ів)
[2025-10-04 07:01:18] [INFO] Оновлюємо колонку 'Error'...
[2025-10-04 07:01:18] [INFO] Формуємо перекреслення...
[2025-10-04 07:01:18] 
[2025-10-04 07:01:18] [OK] Конфліктів не знайдено.
[2025-10-04 07:01:18] 
[2025-10-04 07:01:18] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-10-04 07:01:18] [TIME] Час виконання скрипта fill_flat_schedule.py: 57.16 сек.
[2025-10-04 07:01:18] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-10-04 07:01:21] [INFO] Нічого не видалено.
[2025-10-04 07:01:21] [OK] Додано: 304, Оновлено: 0, Пропущено: 0
[2025-10-04 07:01:21] [TIME] Час виконання скрипта worktime.py: 2.79 сек.
[2025-10-04 07:01:21] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-10-04 07:01:37] [START] Скрипт запущено: 2025-10-04 07:01:22
[2025-10-04 07:01:37] [OK] Отримано 16 рядків із Google Sheets.
[2025-10-04 07:01:37] [OK] Колонка ID оновлена у Google Sheets.
[2025-10-04 07:01:37] [OK] Діапазони захищено у Google Sheets.
[2025-10-04 07:01:37] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-10-04 07:01:37] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-10-04 07:01:37] [OK] Дані оновлені у Google Sheets.
[2025-10-04 07:01:37] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 16 рядків.
[2025-10-04 07:01:37] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 16.21 сек.
[2025-10-04 07:01:37] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-10-04 07:01:37]   File "/root/Python/ZP/sync_умови_рівень.py", line 317
[2025-10-04 07:01:37]     else:
[2025-10-04 07:01:37]     ^^^^
[2025-10-04 07:01:37] SyntaxError: invalid syntax
[2025-10-04 07:01:37] [TIME] Час виконання скрипта sync_умови_рівень.py: 0.03 сек.
[2025-10-04 07:01:37] [ERROR] Помилка виконання: sync_умови_рівень.py (exit=1). Зупиняємо.
[2025-10-04 07:01:37] [FINISH] Загальний час виконання: 146.78 сек.
================================================================================
[2025-10-04 07:20:39] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 07:20:39] 
[RUN] Виконую скрипт: truncate_zp_tables.py
------------------------------------------------------------
[2025-10-04 07:20:40] [INFO] Підключення до БД olexii_raid@127.0.0.1:3306/petwealth
[2025-10-04 07:20:40] [RUN] TRUNCATE `petwealth`.`zp_collective_bonus` ...
[2025-10-04 07:20:40] [OK] Очищено: `petwealth`.`zp_collective_bonus`
[2025-10-04 07:20:40] [RUN] TRUNCATE `petwealth`.`zp_log_schedule_errors` ...
[2025-10-04 07:20:40] [OK] Очищено: `petwealth`.`zp_log_schedule_errors`
[2025-10-04 07:20:40] [RUN] TRUNCATE `petwealth`.`zp_sales_prem` ...
[2025-10-04 07:20:40] [OK] Очищено: `petwealth`.`zp_sales_prem`
[2025-10-04 07:20:40] [RUN] TRUNCATE `petwealth`.`zp_sales_salary` ...
[2025-10-04 07:20:40] [OK] Очищено: `petwealth`.`zp_sales_salary`
[2025-10-04 07:20:40] [RUN] TRUNCATE `petwealth`.`zp_summary` ...
[2025-10-04 07:20:40] [OK] Очищено: `petwealth`.`zp_summary`
[2025-10-04 07:20:40] [RUN] TRUNCATE `petwealth`.`zp_worktime` ...
[2025-10-04 07:20:40] [OK] Очищено: `petwealth`.`zp_worktime`
[2025-10-04 07:20:40] [RUN] TRUNCATE `petwealth`.`zp_довСпівробітники` ...
[2025-10-04 07:20:40] [OK] Очищено: `petwealth`.`zp_довСпівробітники`
[2025-10-04 07:20:40] [RUN] TRUNCATE `petwealth`.`zp_фктРівніСпівробітників` ...
[2025-10-04 07:20:40] [OK] Очищено: `petwealth`.`zp_фктРівніСпівробітників`
[2025-10-04 07:20:40] [RUN] TRUNCATE `petwealth`.`zp_фктУмовиОплати` ...
[2025-10-04 07:20:40] [OK] Очищено: `petwealth`.`zp_фктУмовиОплати`
[2025-10-04 07:20:40] [RUN] TRUNCATE `petwealth`.`zp_rule_eval_debug` ...
[2025-10-04 07:20:40] [OK] Очищено: `petwealth`.`zp_rule_eval_debug`
[2025-10-04 07:20:40] ----------------------------------------
[2025-10-04 07:20:40] [SUMMARY] Результати очищення:
[2025-10-04 07:20:40]   Очищено: zp_collective_bonus, zp_log_schedule_errors, zp_sales_prem, zp_sales_salary, zp_summary, zp_worktime, zp_довСпівробітники, zp_фктРівніСпівробітників, zp_фктУмовиОплати, zp_rule_eval_debug
[2025-10-04 07:20:40] [TIME] Час виконання скрипта truncate_zp_tables.py: 0.68 сек.
[2025-10-04 07:20:40] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-10-04 07:20:43] [OK] Отримано 6 записів з Єноту
[2025-10-04 07:20:43] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-10-04 07:20:43] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-10-04 07:20:43] [TIME] Час виконання скрипта import_enote_reference.py: 2.94 сек.
[2025-10-04 07:20:43] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-10-04 07:21:10] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-10-04 07:21:10] [TIME] Час виконання скрипта auto_fill_idx.py: 27.59 сек.
[2025-10-04 07:21:10] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-10-04 07:21:55] 
[2025-10-04 07:21:55] [LOG] Початок перевірки графіка — 2025-10-04 07:21:11
[2025-10-04 07:21:55] [LOG] Отримано 31 співробітників з Єнота
[2025-10-04 07:21:55] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-10-04 07:21:55] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-10-04 07:21:55] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-10-04 07:21:55] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-10-04 07:21:55] 
[2025-10-04 07:21:55] [TIME] Час виконання скрипта diagnose_sheets.py: 44.47 сек.
[2025-10-04 07:21:55] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-10-04 07:22:51] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-10-04 07:22:51]   tgt_ws.update(
[2025-10-04 07:22:52] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-10-04 07:22:52] [OK] Таблиця очищена та заголовок додано.
[2025-10-04 07:22:52] [INFO] Формування нових рядків...
[2025-10-04 07:22:52] [OK] Додано 304 актуальних рядків.
[2025-10-04 07:22:52] [INFO] Перевірка на конфлікти...
[2025-10-04 07:22:52] [INFO] Виявлено 0 конфлікт(ів)
[2025-10-04 07:22:52] [INFO] Оновлюємо колонку 'Error'...
[2025-10-04 07:22:52] [INFO] Формуємо перекреслення...
[2025-10-04 07:22:52] 
[2025-10-04 07:22:52] [OK] Конфліктів не знайдено.
[2025-10-04 07:22:52] 
[2025-10-04 07:22:52] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-10-04 07:22:52] [TIME] Час виконання скрипта fill_flat_schedule.py: 57.69 сек.
[2025-10-04 07:22:52] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-10-04 07:22:55] [INFO] Нічого не видалено.
[2025-10-04 07:22:55] [OK] Додано: 304, Оновлено: 0, Пропущено: 0
[2025-10-04 07:22:56] [TIME] Час виконання скрипта worktime.py: 3.21 сек.
[2025-10-04 07:22:56] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-10-04 07:23:13] [START] Скрипт запущено: 2025-10-04 07:22:56
[2025-10-04 07:23:13] [OK] Отримано 16 рядків із Google Sheets.
[2025-10-04 07:23:13] [OK] Колонка ID оновлена у Google Sheets.
[2025-10-04 07:23:13] [OK] Діапазони захищено у Google Sheets.
[2025-10-04 07:23:13] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-10-04 07:23:13] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-10-04 07:23:13] [OK] Дані оновлені у Google Sheets.
[2025-10-04 07:23:13] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 16 рядків.
[2025-10-04 07:23:13] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 17.6 сек.
[2025-10-04 07:23:13] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-10-04 07:23:17] [2025-10-04 07:23:14] [SYNC] Початок синхронізації рівнів співробітників...
[2025-10-04 07:23:17] [2025-10-04 07:23:16] [OK] Google Sheets оновлено!
[2025-10-04 07:23:17] [2025-10-04 07:23:17] [OK] Завантажено: 40 додано, 0 оновлено.
[2025-10-04 07:23:17] [2025-10-04 07:23:17] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-10-04 07:23:17] [2025-10-04 07:23:17] [OK] Обробка завершена!
[2025-10-04 07:23:17] [TIME] Час виконання скрипта sync_умови_рівень.py: 4.05 сек.
[2025-10-04 07:23:17] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-10-04 07:23:59] [INFO] Виконуємо SQL-запит...
[2025-10-04 07:23:59] [OK] Отримано 48392 рядків
[2025-10-04 07:23:59] [OK] Дублікатів за ключовими полями немає.
[2025-10-04 07:23:59] [DELETE] Очищення старих записів...
[2025-10-04 07:23:59] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-10-04 07:23:59] [OK] Дані успішно завантажені!
[2025-10-04 07:23:59] [TIME] Час виконання скрипта zp_sales_salary_new.py: 41.54 сек.
[2025-10-04 07:23:59] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-10-04 07:24:04] [SYNC] Розпочато обробку змін...
[2025-10-04 07:24:04] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-10-04 07:24:04] [OK] Отримано 304 змін для обробки.
[2025-10-04 07:24:04] [FINISH] Обробка завершена: 66 записів премій.
[2025-10-04 07:24:04] [TIME] Час виконання скрипта zp_collective_bonus.py: 5.22 сек.
[2025-10-04 07:24:04] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-10-04 07:24:06] 
[2025-10-04 07:24:06] ===============================
[2025-10-04 07:24:06] Період від 2025-05-01
[2025-10-04 07:24:06] По Стоимость: 467,168.89
[2025-10-04 07:24:06] По СтоимостьБезСкидок: 468,828.45
[2025-10-04 07:24:06] По ВаловийПрибуток: 454,781.19
[2025-10-04 07:24:06] ===============================
[2025-10-04 07:24:06] 
[2025-10-04 07:24:06] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-10-04 07:24:06] [TIME] Час виконання скрипта summary.py: 2.03 сек.
[2025-10-04 07:24:06] [FINISH] Загальний час виконання: 207.03 сек.
================================================================================
[2025-10-04 13:48:03] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 13:48:03] 
[RUN] Виконую скрипт: truncate_zp_tables.py
------------------------------------------------------------
[2025-10-04 13:48:04] [INFO] Підключення до БД olexii_raid@127.0.0.1:3306/petwealth
[2025-10-04 13:48:04] [RUN] TRUNCATE `petwealth`.`zp_collective_bonus` ...
[2025-10-04 13:48:04] [OK] Очищено: `petwealth`.`zp_collective_bonus`
[2025-10-04 13:48:04] [RUN] TRUNCATE `petwealth`.`zp_log_schedule_errors` ...
[2025-10-04 13:48:04] [OK] Очищено: `petwealth`.`zp_log_schedule_errors`
[2025-10-04 13:48:04] [RUN] TRUNCATE `petwealth`.`zp_sales_prem` ...
[2025-10-04 13:48:04] [OK] Очищено: `petwealth`.`zp_sales_prem`
[2025-10-04 13:48:04] [RUN] TRUNCATE `petwealth`.`zp_sales_salary` ...
[2025-10-04 13:48:04] [OK] Очищено: `petwealth`.`zp_sales_salary`
[2025-10-04 13:48:04] [RUN] TRUNCATE `petwealth`.`zp_summary` ...
[2025-10-04 13:48:04] [OK] Очищено: `petwealth`.`zp_summary`
[2025-10-04 13:48:04] [RUN] TRUNCATE `petwealth`.`zp_worktime` ...
[2025-10-04 13:48:04] [OK] Очищено: `petwealth`.`zp_worktime`
[2025-10-04 13:48:04] [RUN] TRUNCATE `petwealth`.`zp_довСпівробітники` ...
[2025-10-04 13:48:04] [OK] Очищено: `petwealth`.`zp_довСпівробітники`
[2025-10-04 13:48:04] [RUN] TRUNCATE `petwealth`.`zp_фктРівніСпівробітників` ...
[2025-10-04 13:48:04] [OK] Очищено: `petwealth`.`zp_фктРівніСпівробітників`
[2025-10-04 13:48:04] [RUN] TRUNCATE `petwealth`.`zp_фктУмовиОплати` ...
[2025-10-04 13:48:04] [OK] Очищено: `petwealth`.`zp_фктУмовиОплати`
[2025-10-04 13:48:04] [RUN] TRUNCATE `petwealth`.`zp_rule_eval_debug` ...
[2025-10-04 13:48:04] [OK] Очищено: `petwealth`.`zp_rule_eval_debug`
[2025-10-04 13:48:04] ----------------------------------------
[2025-10-04 13:48:04] [SUMMARY] Результати очищення:
[2025-10-04 13:48:04]   Очищено: zp_collective_bonus, zp_log_schedule_errors, zp_sales_prem, zp_sales_salary, zp_summary, zp_worktime, zp_довСпівробітники, zp_фктРівніСпівробітників, zp_фктУмовиОплати, zp_rule_eval_debug
[2025-10-04 13:48:04] [TIME] Час виконання скрипта truncate_zp_tables.py: 1.0 сек.
[2025-10-04 13:48:04] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-10-04 13:48:08] [OK] Отримано 6 записів з Єноту
[2025-10-04 13:48:08] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-10-04 13:48:08] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-10-04 13:48:08] [TIME] Час виконання скрипта import_enote_reference.py: 3.71 сек.
[2025-10-04 13:48:08] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-10-04 13:48:40] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-10-04 13:48:40] [TIME] Час виконання скрипта auto_fill_idx.py: 31.89 сек.
[2025-10-04 13:48:40] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-10-04 13:49:28] 
[2025-10-04 13:49:28] [LOG] Початок перевірки графіка — 2025-10-04 13:48:41
[2025-10-04 13:49:28] [LOG] Отримано 31 співробітників з Єнота
[2025-10-04 13:49:28] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-10-04 13:49:28] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-10-04 13:49:28] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-10-04 13:49:28] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-10-04 13:49:28] 
[2025-10-04 13:49:28] [TIME] Час виконання скрипта diagnose_sheets.py: 48.23 сек.
[2025-10-04 13:49:28] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-10-04 13:50:28] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-10-04 13:50:28]   tgt_ws.update(
[2025-10-04 13:50:31] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-10-04 13:50:31] [OK] Таблиця очищена та заголовок додано.
[2025-10-04 13:50:31] [INFO] Формування нових рядків...
[2025-10-04 13:50:31] [OK] Додано 304 актуальних рядків.
[2025-10-04 13:50:31] [INFO] Перевірка на конфлікти...
[2025-10-04 13:50:31] [INFO] Виявлено 0 конфлікт(ів)
[2025-10-04 13:50:31] [INFO] Оновлюємо колонку 'Error'...
[2025-10-04 13:50:31] [INFO] Формуємо перекреслення...
[2025-10-04 13:50:31] 
[2025-10-04 13:50:31] [OK] Конфліктів не знайдено.
[2025-10-04 13:50:31] 
[2025-10-04 13:50:31] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-10-04 13:50:31] [TIME] Час виконання скрипта fill_flat_schedule.py: 62.5 сек.
[2025-10-04 13:50:31] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-10-04 13:50:33] [INFO] Нічого не видалено.
[2025-10-04 13:50:33] [OK] Додано: 304, Оновлено: 0, Пропущено: 0
[2025-10-04 13:50:34] [TIME] Час виконання скрипта worktime.py: 2.84 сек.
[2025-10-04 13:50:34] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-10-04 13:50:53] [START] Скрипт запущено: 2025-10-04 13:50:34
[2025-10-04 13:50:53] [OK] Отримано 16 рядків із Google Sheets.
[2025-10-04 13:50:53] [OK] Колонка ID оновлена у Google Sheets.
[2025-10-04 13:50:53] [OK] Діапазони захищено у Google Sheets.
[2025-10-04 13:50:53] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-10-04 13:50:53] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-10-04 13:50:53] [OK] Дані оновлені у Google Sheets.
[2025-10-04 13:50:53] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 16 рядків.
[2025-10-04 13:50:53] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 19.37 сек.
[2025-10-04 13:50:53] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-10-04 13:50:56] [2025-10-04 13:50:54] [SYNC] Початок синхронізації рівнів співробітників...
[2025-10-04 13:50:56] [2025-10-04 13:50:56] [OK] Google Sheets оновлено!
[2025-10-04 13:50:56] [2025-10-04 13:50:56] [OK] Завантажено: 41 додано, 0 оновлено.
[2025-10-04 13:50:56] [2025-10-04 13:50:56] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-10-04 13:50:56] [2025-10-04 13:50:56] [OK] Обробка завершена!
[2025-10-04 13:50:57] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.53 сек.
[2025-10-04 13:50:57] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-10-04 13:51:40] [INFO] Виконуємо SQL-запит...
[2025-10-04 13:51:40] [OK] Отримано 48392 рядків
[2025-10-04 13:51:40] [OK] Дублікатів за ключовими полями немає.
[2025-10-04 13:51:40] [DELETE] Очищення старих записів...
[2025-10-04 13:51:40] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-10-04 13:51:40] [OK] Дані успішно завантажені!
[2025-10-04 13:51:40] [TIME] Час виконання скрипта zp_sales_salary_new.py: 43.73 сек.
[2025-10-04 13:51:40] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-10-04 13:51:45] [SYNC] Розпочато обробку змін...
[2025-10-04 13:51:45] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-10-04 13:51:45] [OK] Отримано 304 змін для обробки.
[2025-10-04 13:51:45] [FINISH] Обробка завершена: 66 записів премій.
[2025-10-04 13:51:45] [TIME] Час виконання скрипта zp_collective_bonus.py: 5.18 сек.
[2025-10-04 13:51:45] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-10-04 13:51:47] 
[2025-10-04 13:51:47] ===============================
[2025-10-04 13:51:47] Період від 2025-05-01
[2025-10-04 13:51:47] По Стоимость: 470,168.89
[2025-10-04 13:51:47] По СтоимостьБезСкидок: 471,828.45
[2025-10-04 13:51:47] По ВаловийПрибуток: 457,781.19
[2025-10-04 13:51:47] ===============================
[2025-10-04 13:51:47] 
[2025-10-04 13:51:47] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-10-04 13:51:47] [TIME] Час виконання скрипта summary.py: 1.92 сек.
[2025-10-04 13:51:47] [FINISH] Загальний час виконання: 223.93 сек.
================================================================================
[2025-10-04 13:57:54] Запущено з командою: /root/Python/ZP/run_all.py
================================================================================
[2025-10-04 13:57:54] 
[RUN] Виконую скрипт: truncate_zp_tables.py
------------------------------------------------------------
[2025-10-04 13:57:55] [INFO] Підключення до БД olexii_raid@127.0.0.1:3306/petwealth
[2025-10-04 13:57:55] [RUN] TRUNCATE `petwealth`.`zp_collective_bonus` ...
[2025-10-04 13:57:55] [OK] Очищено: `petwealth`.`zp_collective_bonus`
[2025-10-04 13:57:55] [RUN] TRUNCATE `petwealth`.`zp_log_schedule_errors` ...
[2025-10-04 13:57:55] [OK] Очищено: `petwealth`.`zp_log_schedule_errors`
[2025-10-04 13:57:55] [RUN] TRUNCATE `petwealth`.`zp_sales_prem` ...
[2025-10-04 13:57:55] [OK] Очищено: `petwealth`.`zp_sales_prem`
[2025-10-04 13:57:55] [RUN] TRUNCATE `petwealth`.`zp_sales_salary` ...
[2025-10-04 13:57:55] [OK] Очищено: `petwealth`.`zp_sales_salary`
[2025-10-04 13:57:55] [RUN] TRUNCATE `petwealth`.`zp_summary` ...
[2025-10-04 13:57:55] [OK] Очищено: `petwealth`.`zp_summary`
[2025-10-04 13:57:55] [RUN] TRUNCATE `petwealth`.`zp_worktime` ...
[2025-10-04 13:57:55] [OK] Очищено: `petwealth`.`zp_worktime`
[2025-10-04 13:57:55] [RUN] TRUNCATE `petwealth`.`zp_довСпівробітники` ...
[2025-10-04 13:57:55] [OK] Очищено: `petwealth`.`zp_довСпівробітники`
[2025-10-04 13:57:55] [RUN] TRUNCATE `petwealth`.`zp_фктРівніСпівробітників` ...
[2025-10-04 13:57:55] [OK] Очищено: `petwealth`.`zp_фктРівніСпівробітників`
[2025-10-04 13:57:55] [RUN] TRUNCATE `petwealth`.`zp_фктУмовиОплати` ...
[2025-10-04 13:57:55] [OK] Очищено: `petwealth`.`zp_фктУмовиОплати`
[2025-10-04 13:57:55] [RUN] TRUNCATE `petwealth`.`zp_rule_eval_debug` ...
[2025-10-04 13:57:55] [OK] Очищено: `petwealth`.`zp_rule_eval_debug`
[2025-10-04 13:57:55] ----------------------------------------
[2025-10-04 13:57:55] [SUMMARY] Результати очищення:
[2025-10-04 13:57:55]   Очищено: zp_collective_bonus, zp_log_schedule_errors, zp_sales_prem, zp_sales_salary, zp_summary, zp_worktime, zp_довСпівробітники, zp_фктРівніСпівробітників, zp_фктУмовиОплати, zp_rule_eval_debug
[2025-10-04 13:57:55] [TIME] Час виконання скрипта truncate_zp_tables.py: 0.65 сек.
[2025-10-04 13:57:55] 
[RUN] Виконую скрипт: import_enote_reference.py
------------------------------------------------------------
[2025-10-04 13:57:59] [OK] Отримано 6 записів з Єноту
[2025-10-04 13:57:59] [DELETE] Дані на листі 'дов_АнЗП' очищено.
[2025-10-04 13:57:59] [OK] Дані успішно оновлено на листі 'дов_АнЗП'.
[2025-10-04 13:57:59] [TIME] Час виконання скрипта import_enote_reference.py: 3.65 сек.
[2025-10-04 13:57:59] 
[RUN] Виконую скрипт: auto_fill_idx.py
------------------------------------------------------------
[2025-10-04 13:58:28] [WARN] Нічого оновлювати — всі IDX вже заповнені або немає рядків з 'Посада'.
[2025-10-04 13:58:29] [TIME] Час виконання скрипта auto_fill_idx.py: 29.87 сек.
[2025-10-04 13:58:29] 
[RUN] Виконую скрипт: diagnose_sheets.py
------------------------------------------------------------
[2025-10-04 13:59:15] 
[2025-10-04 13:59:15] [LOG] Початок перевірки графіка — 2025-10-04 13:58:29
[2025-10-04 13:59:15] [LOG] Отримано 31 співробітників з Єнота
[2025-10-04 13:59:15] [LOG] Оновлено дов_Співробітники — 31 рядків
[2025-10-04 13:59:15] [LOG] Дані записано в таблицю zp_довСпівробітники — 31 рядків
[2025-10-04 13:59:15] [LOG] Починаємо перевірку клітинок з H2 по AL...
[2025-10-04 13:59:15] [LOG] Перевірка завершена. Некоректних клітинок: 0, очищено форматів: 304
[2025-10-04 13:59:15] 
[2025-10-04 13:59:15] [TIME] Час виконання скрипта diagnose_sheets.py: 46.7 сек.
[2025-10-04 13:59:15] 
[RUN] Виконую скрипт: fill_flat_schedule.py
------------------------------------------------------------
[2025-10-04 14:00:15] /root/Python/ZP/fill_flat_schedule.py:244: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
[2025-10-04 14:00:15]   tgt_ws.update(
[2025-10-04 14:00:17] [INFO] Авторизація пройдена. Завантаження існуючих даних...
[2025-10-04 14:00:17] [OK] Таблиця очищена та заголовок додано.
[2025-10-04 14:00:17] [INFO] Формування нових рядків...
[2025-10-04 14:00:17] [OK] Додано 304 актуальних рядків.
[2025-10-04 14:00:17] [INFO] Перевірка на конфлікти...
[2025-10-04 14:00:17] [INFO] Виявлено 0 конфлікт(ів)
[2025-10-04 14:00:17] [INFO] Оновлюємо колонку 'Error'...
[2025-10-04 14:00:17] [INFO] Формуємо перекреслення...
[2025-10-04 14:00:17] 
[2025-10-04 14:00:17] [OK] Конфліктів не знайдено.
[2025-10-04 14:00:17] 
[2025-10-04 14:00:17] [OK] Завершено: таблицю оновлено та перевірено на перехльости.
[2025-10-04 14:00:18] [TIME] Час виконання скрипта fill_flat_schedule.py: 62.43 сек.
[2025-10-04 14:00:18] 
[RUN] Виконую скрипт: worktime.py
------------------------------------------------------------
[2025-10-04 14:00:21] [INFO] Нічого не видалено.
[2025-10-04 14:00:21] [OK] Додано: 304, Оновлено: 0, Пропущено: 0
[2025-10-04 14:00:21] [TIME] Час виконання скрипта worktime.py: 3.17 сек.
[2025-10-04 14:00:21] 
[RUN] Виконую скрипт: sync_fkt_UmoviOplaty.py
------------------------------------------------------------
[2025-10-04 14:00:40] [START] Скрипт запущено: 2025-10-04 14:00:22
[2025-10-04 14:00:40] [OK] Отримано 17 рядків із Google Sheets.
[2025-10-04 14:00:40] [OK] Колонка ID оновлена у Google Sheets.
[2025-10-04 14:00:40] [OK] Діапазони захищено у Google Sheets.
[2025-10-04 14:00:40] [OK] Всього змінено ДатаЗакінчення у 0 рядках.
[2025-10-04 14:00:40] [OK] Rule_ID стабільно присвоєно для всіх рядків.
[2025-10-04 14:00:40] [OK] Дані оновлені у Google Sheets.
[2025-10-04 14:00:40] [OK] Дані перезаписані у БД (zp_фктУмовиОплати). Вставлено 17 рядків.
[2025-10-04 14:00:40] [TIME] Час виконання скрипта sync_fkt_UmoviOplaty.py: 18.89 сек.
[2025-10-04 14:00:40] 
[RUN] Виконую скрипт: sync_умови_рівень.py
------------------------------------------------------------
[2025-10-04 14:00:43] [2025-10-04 14:00:40] [SYNC] Початок синхронізації рівнів співробітників...
[2025-10-04 14:00:43] [2025-10-04 14:00:43] [OK] Google Sheets оновлено!
[2025-10-04 14:00:43] [2025-10-04 14:00:43] [OK] Завантажено: 41 додано, 0 оновлено.
[2025-10-04 14:00:43] [2025-10-04 14:00:43] [INFO] Початок розрахунку збігів у zp_worktime...
[2025-10-04 14:00:43] [2025-10-04 14:00:43] [OK] Обробка завершена!
[2025-10-04 14:00:44] [TIME] Час виконання скрипта sync_умови_рівень.py: 3.91 сек.
[2025-10-04 14:00:44] 
[RUN] Виконую скрипт: zp_sales_salary_new.py
------------------------------------------------------------
[2025-10-04 14:01:24] [INFO] Виконуємо SQL-запит...
[2025-10-04 14:01:24] [OK] Отримано 48392 рядків
[2025-10-04 14:01:24] [OK] Дублікатів за ключовими полями немає.
[2025-10-04 14:01:24] [DELETE] Очищення старих записів...
[2025-10-04 14:01:24] [LOAD] Завантажуємо дані у zp_sales_salary...
[2025-10-04 14:01:24] [OK] Дані успішно завантажені!
[2025-10-04 14:01:24] [TIME] Час виконання скрипта zp_sales_salary_new.py: 40.79 сек.
[2025-10-04 14:01:24] 
[RUN] Виконую скрипт: zp_collective_bonus.py
------------------------------------------------------------
[2025-10-04 14:01:29] [SYNC] Розпочато обробку змін...
[2025-10-04 14:01:29] [CLEAN] Таблиця zp_collective_bonus очищена.
[2025-10-04 14:01:29] [OK] Отримано 304 змін для обробки.
[2025-10-04 14:01:29] [FINISH] Обробка завершена: 66 записів премій.
[2025-10-04 14:01:29] [TIME] Час виконання скрипта zp_collective_bonus.py: 4.5 сек.
[2025-10-04 14:01:29] 
[RUN] Виконую скрипт: summary.py
------------------------------------------------------------
[2025-10-04 14:01:30] 
[2025-10-04 14:01:30] ===============================
[2025-10-04 14:01:30] Період від 2025-05-01
[2025-10-04 14:01:30] По Стоимость: 466,527.27
[2025-10-04 14:01:30] По СтоимостьБезСкидок: 468,186.83
[2025-10-04 14:01:30] По ВаловийПрибуток: 454,139.57
[2025-10-04 14:01:30] ===============================
[2025-10-04 14:01:30] 
[2025-10-04 14:01:30] [OK] Дані успішно завантажено у таблицю zp_summary.
[2025-10-04 14:01:31] [TIME] Час виконання скрипта summary.py: 1.78 сек.
[2025-10-04 14:01:31] [FINISH] Загальний час виконання: 216.35 сек.

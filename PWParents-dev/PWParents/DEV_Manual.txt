üêæ PetWealth Parents ‚Äî Dev Version

–ú–µ—Ç–∞: —Ä–æ–±–æ—á–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è Telegram-–±–æ—Ç–∞ PetWealth Parents
(—Å–∞–ø–ø–æ—Ä—Ç-–≥—Ä—É–ø–∞, –ø—Ä–∏–≤‚Äô—è–∑–∫–∞ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –¥–æ –Ñ–Ω–æ—Ç–∞, –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–µ–ª–µ—Ñ–æ–Ω—ñ–≤, —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó, –ª–æ–≥–∏).

‚öôÔ∏è –°–µ—Ä–µ–¥–æ–≤–∏—â–µ

Python: 3.12
–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –±–æ—Ç–∞: aiogram 3.x
–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö: MySQL / MariaDB
–§–∞–π–ª–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

PWParents-dev/PWParents/
‚îú‚îÄ‚îÄ app/ ‚Äî –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É (main.py)
‚îú‚îÄ‚îÄ bot/
‚îÇ ‚îú‚îÄ‚îÄ routers/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ staff.py ‚Äî –∫–æ–º–∞–Ω–¥–∞ /phone, /client
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ enote_link.py ‚Äî –∫–æ–º–∞–Ω–¥–∞ /enote_link
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ root.py ‚Äî –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ä–æ—É—Ç–µ—Ä—ñ–≤
‚îÇ ‚îú‚îÄ‚îÄ auth.py
‚îÇ ‚îú‚îÄ‚îÄ service/
‚îÇ ‚îî‚îÄ‚îÄ utils/
‚îú‚îÄ‚îÄ core/
‚îÇ ‚îú‚îÄ‚îÄ config.py ‚Äî —á–∏—Ç–∞–Ω–Ω—è .env
‚îÇ ‚îú‚îÄ‚îÄ db.py ‚Äî MySQL-–∫–æ–Ω–µ–∫—Ç
‚îÇ ‚îú‚îÄ‚îÄ integrations/
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ enote.py ‚Äî —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –Ñ–Ω–æ—Ç–æ–º (OData + API)
‚îÇ ‚îú‚îÄ‚îÄ logging_setup.py ‚Äî –ª–æ–≥—É–≤–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥–∏ /enote_link
‚îÇ ‚îî‚îÄ‚îÄ repositories/
‚îÇ ‚îî‚îÄ‚îÄ clients.py ‚Äî update_enote_link, get_client —Ç–æ—â–æ
‚îî‚îÄ‚îÄ logs/
‚îî‚îÄ‚îÄ enote_link.log ‚Äî –ª–æ–≥ –∫–æ–º–∞–Ω–¥–∏ /enote_link

üîê .env (–º—ñ–Ω—ñ–º—É–º –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ–≥–æ)

BOT_TOKEN=...
BOT_USERNAME=PetWealthParentsBot
SUPPORT_GROUP_ID=-1002992147362

DB_HOST=127.0.0.1
DB_PORT=3306
DB_USER=olexii_raid
DB_PASSWORD=Z4vBrpT7@9uLMxWg
DB_NAME=petwealth

ENOTE_ODATA_URL=https://app.enote.vet/
<uuid>/odata/standard.odata
ENOTE_ODATA_USER=odata
ENOTE_ODATA_PASS=********
ENOTE_API_URL=https://app.enote.vet/
<uuid>/hs/api/v2
ENOTE_API_KEY=********************************

üß© –ö–æ–º–∞–Ω–¥–∏ –¥–ª—è —Å–∞–ø–ø–æ—Ä—Ç—É
/enote_link

–ü—Ä–∏–≤‚Äô—è–∑—É—î –∫–ª—ñ—î–Ω—Ç–∞ (—É —Ç–µ–º—ñ —Å–∞–ø–ø–æ—Ä—Ç-–≥—Ä—É–ø–∏) –¥–æ –≤–ª–∞—Å–Ω–∏–∫–∞ –≤ –Ñ–Ω–æ—Ç—ñ.

–Ø–∫ –ø—Ä–∞—Ü—é—î:

–í–∏–∫–æ–Ω–∞—Ç–∏ /enote_link —É —Ç–µ–º—ñ –∫–ª—ñ—î–Ω—Ç–∞ (reply –Ω–∞ –π–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è).

–í–≤–µ—Å—Ç–∏ –Ω–æ–º–µ—Ä –¥–æ–≥–æ–≤–æ—Ä—É –∑ –Ñ–Ω–æ—Ç–∞.

–ë–æ—Ç –∑–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ –Ñ–Ω–æ—Ç–∞:
‚Äì –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –≤–ª–∞—Å–Ω–∏–∫–∞;
‚Äì –æ—Ç—Ä–∏–º—É—î Ref_Key, –ü–Ü–ë, —Ç–µ–ª–µ—Ñ–æ–Ω;
‚Äì –ø–æ–∫–∞–∑—É—î —Å–ø–∏—Å–æ–∫ —Ç–≤–∞—Ä–∏–Ω.

–ü—ñ—Å–ª—è –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è ‚úÖ –æ–Ω–æ–≤–ª—é—î pp_clients:
‚Äì owner_ref_key
‚Äì owner_name_enote
‚Äì owner_phone_enote
‚Äì linked_contract_number
‚Äì linked_by, linked_at

–°–ª—É–∂–±–æ–≤–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —É —Ç–µ–º—É:

‚úÖ –ü—Ä–∏–≤‚Äô—è–∑–∞–Ω–æ –≤–ª–∞—Å–Ω–∏–∫–∞ –∑ –Ñ–Ω–æ—Ç–∞
üë§ –ü–Ü–ë: –Ü–≤–∞–Ω–µ–Ω–∫–æ –û–ª–µ–∫—Å–∞–Ω–¥—Ä
üìû –¢–µ–ª–µ—Ñ–æ–Ω (–Ñ–Ω–æ—Ç): +380501234567
üîó owner_ref_key: aaaa-bbbb-cccc
üßæ –î–æ–≥–æ–≤—ñ—Ä: 12345
–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å: @staff (ID 999)

–õ–æ–≥–∏: logs/enote_link.log

2025-11-05 19:22:10 | INFO | linked | chat=-100... client=12345 contract=123 owner_ref=...

/phone (–∞–±–æ /client)

–í–∏–≤–æ–¥–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–ª—ñ—î–Ω—Ç–∞ –≤ —Ç–µ–º—ñ:

label / –ü–Ü–ë

Telegram ID (–∑ –∫–ª—ñ–∫–∞–±–µ–ª—å–Ω–∏–º –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º)

–Ω—ñ–∫–Ω–µ–π–º (@username)

—Ç–µ–ª–µ—Ñ–æ–Ω–∏ (–±–æ—Ç / –Ñ–Ω–æ—Ç)

–∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–∫—Ä–∏—Ç–∏—Ö –∑–≤–µ—Ä–Ω–µ–Ω—å

–õ–æ–≥—ñ–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω—ñ–≤:

–Ø–∫—â–æ –∑–±—ñ–≥–∞—é—Ç—å—Å—è ‚Üí
üìû +380501234567 (–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ ‚úÖ)

–Ø–∫—â–æ —Ä—ñ–∑–Ω—ñ ‚Üí
üìû –ö–ª—ñ—î–Ω—Ç (–±–æ—Ç): +380501234567 (–ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ ‚úÖ)
üìû –Ñ–Ω–æ—Ç: +380671112233 [enote]

–Ø–∫—â–æ —î –ª–∏—à–µ –æ–¥–∏–Ω ‚Üí –ø–æ–∫–∞–∑—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –∑ –ø–æ–∑–Ω–∞—á–∫–æ—é [enote] –∞–±–æ (–ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ ‚úÖ)

üß± –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö

–¢–∞–±–ª–∏—Ü—è pp_clients (–¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∫–æ–ª–æ–Ω–∫–∏):

ALTER TABLE pp_clients
ADD COLUMN owner_ref_key CHAR(36),
ADD COLUMN owner_name_enote VARCHAR(255),
ADD COLUMN owner_phone_enote VARCHAR(32),
ADD COLUMN linked_contract_number VARCHAR(64),
ADD COLUMN linked_by BIGINT,
ADD COLUMN linked_at DATETIME,
ADD INDEX idx_pp_clients_owner_ref_key (owner_ref_key);

ü™µ –õ–æ–≥–∏

–§–∞–π–ª ‚Äî –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è
logs/enote_link.log ‚Äî –ø–æ–¥—ñ—ó –∫–æ–º–∞–Ω–¥–∏ /enote_link (preview, linked, cancel, error)
infra/logging.py ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ñ –ª–æ–≥–∏ –∑–∞–ø—É—Å–∫—É –±–æ—Ç–∞ (–Ω–µ —á—ñ–ø–∞—Ç–∏)

–§–æ—Ä–º–∞—Ç:

2025-11-05 19:22:10 | INFO | linked | chat=-1002992147362 client=123456789 contract=12345 owner_ref=... actor=111

üîß –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –±–æ—Ç–∞ (main.py).

–£ —Å–∞–ø–ø–æ—Ä—Ç-–≥—Ä—É–ø—ñ, –≤ —Ç–µ–º—ñ –∫–ª—ñ—î–Ω—Ç–∞:
‚Äì /enote_link ‚Üí –≤–≤–µ—Å—Ç–∏ –Ω–æ–º–µ—Ä –¥–æ–≥–æ–≤–æ—Ä—É ‚Üí ‚úÖ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏.
‚Äì /phone ‚Üí –ø–æ–±–∞—á–∏—Ç–∏ –æ–±–∏–¥–≤–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∏.

–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏:
tail -f logs/enote_link.log

–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –∑–º—ñ–Ω–∏ –≤ pp_clients:
SELECT telegram_id, owner_ref_key, owner_phone_enote, linked_contract_number FROM pp_clients WHERE telegram_id=...;

üìÑ –ê–≤—Ç–æ—Ä–∏ / Dev-–∫–æ–Ω—Ç–∞–∫—Ç–∏

–û–ª–µ–∫—Å—ñ–π –õ—å–æ–¥—ñ–Ω ‚Äî PetWealth Clinic
PetWealth Parents DevBot ‚Äî –≤–Ω—É—Ç—Ä—ñ—à–Ω—è –¥–µ–≤-–≤–µ—Ä—Å—ñ—è
GPT-5 / ChatGPT ‚Äî —Ç–µ—Ö–Ω—ñ—á–Ω–∏–π –∞—Å–∏—Å—Ç–µ–Ω—Ç